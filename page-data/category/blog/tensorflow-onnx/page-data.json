{"componentChunkName":"component---src-templates-post-tsx","path":"/category/blog/tensorflow-onnx/","result":{"data":{"site":{"siteMetadata":{"title":"ì–´ì„œOpShow","author":"ì¥ìˆ˜ì™„","siteUrl":"https://ssuwani.github.io"}},"markdownRemark":{"id":"e3abc3a5-9266-5f11-8792-29904a5cef25","excerpt":"ê¸°ë³¸ì ì¸ ì‚¬ìš©ë²•ë§Œì„ ì‘ì„±í•œ ê¸€ì…ë‹ˆë‹¤.  ëª¨ë¸ ì„±ëŠ¥ í™•ì¸ì„ ìœ„í•´ MNIST ë°ì´í„°ë¡œ í•™ìŠµí•˜ëŠ” ê³¼ì •ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ì°¸ê³ í•œ ì‚¬ì´íŠ¸ tensorflow-onnx ëª©ì°¨ MNIST ëª¨ë¸ í•™ìŠµ ë° ì €ì¥ ONNX tf2onnx ì„¤ì¹˜ ONNXë¡œ ëª¨ë¸ ë³€í™˜ ONNXâ€¦","html":"<blockquote>\n<p>ê¸°ë³¸ì ì¸ ì‚¬ìš©ë²•ë§Œì„ ì‘ì„±í•œ ê¸€ì…ë‹ˆë‹¤. </p>\n</blockquote>\n<blockquote>\n<p>ëª¨ë¸ ì„±ëŠ¥ í™•ì¸ì„ ìœ„í•´ MNIST ë°ì´í„°ë¡œ í•™ìŠµí•˜ëŠ” ê³¼ì •ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<p>ì°¸ê³ í•œ ì‚¬ì´íŠ¸</p>\n<ul>\n<li><a href=\"https://github.com/onnx/tensorflow-onnx\">tensorflow-onnx</a></li>\n</ul>\n<h2 id=\"ëª©ì°¨\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%EC%B0%A8\" aria-label=\"ëª©ì°¨ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ëª©ì°¨</h2>\n<ol>\n<li>MNIST ëª¨ë¸ í•™ìŠµ ë° ì €ì¥</li>\n<li>\n<p>ONNX</p>\n<ol>\n<li>tf2onnx ì„¤ì¹˜</li>\n<li>ONNXë¡œ ëª¨ë¸ ë³€í™˜</li>\n<li>ONNXë¡œ ì¶”ë¡ í•˜ê¸°</li>\n<li>ì •í™•ë„ ë¹„êµ</li>\n<li>ì†ë„ ë¹„êµ</li>\n<li>ì¡°ê¸ˆ ë” ë³µì¡í•œ CNN ëª¨ë¸ ì†ë„ ë¹„êµ</li>\n</ol>\n</li>\n<li>ê²°ë¡ </li>\n</ol>\n<h2 id=\"mnist-ëª¨ë¸-í•™ìŠµ-ë°-ì €ì¥\" style=\"position:relative;\"><a href=\"#mnist-%EB%AA%A8%EB%8D%B8-%ED%95%99%EC%8A%B5-%EB%B0%8F-%EC%A0%80%EC%9E%A5\" aria-label=\"mnist ëª¨ë¸ í•™ìŠµ ë° ì €ì¥ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MNIST ëª¨ë¸ í•™ìŠµ ë° ì €ì¥</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n\n<span class=\"token comment\"># ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</span>\n<span class=\"token punctuation\">(</span>train_x<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>test_x<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>mnist<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntrain_x<span class=\"token punctuation\">,</span> test_x <span class=\"token operator\">=</span> train_x <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span><span class=\"token punctuation\">,</span> test_x <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span>\n\n<span class=\"token comment\"># ëª¨ë¸ ì •ì˜</span>\nmodel <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">[</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span>input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># í•™ìŠµ ê³¼ì • ì„¤ì •</span>\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>\n    loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n    optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n    metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_x<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span> <span class=\"token comment\"># ëª¨ë¸ í•™ìŠµ</span>\n\nmodel<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'tf_model'</span><span class=\"token punctuation\">,</span> include_optimizer<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># ëª¨ë¸ ì €ì¥</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ì½”ë“œë¥¼ ë³´ë©´ íŠ¹ì´í•œ ì ì´ í•˜ë‚˜ ìˆì„ ê²ƒì´ë‹¤. ì œì¼ ì•„ë˜ <code class=\"language-text\">model.save</code>ì— <code class=\"language-text\">include_optimizer=False</code>ê°€ ì¶”ê°€ë˜ì—ˆë‹¤. ì—†ì´ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">slot_variable <span class=\"token operator\">=</span> optimizer_object.add_slot<span class=\"token punctuation\">(</span>\nAttributeError: <span class=\"token string\">'_UserObject'</span> object has no attribute <span class=\"token string\">'add_slot'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>ìµœì í™” í•¨ìˆ˜ì¸ <code class=\"language-text\">optimizer</code>ì— ê´€ë ¨ë˜ì–´ ìˆìŒì„ í™•ì¸í•˜ì˜€ê³  <a href=\"https://www.python2.net/questions-1719470.htm\">ì—¬ê¸°</a>ì—ì„œ íŒíŠ¸ë¥¼ ì–»ì–´ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í•˜ë‹ˆ ë¬¸ì œì—†ì´ ë™ì‘í•˜ì˜€ë‹¤.</p>\n<h2 id=\"onnx\" style=\"position:relative;\"><a href=\"#onnx\" aria-label=\"onnx permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ONNX</h2>\n<h4 id=\"1-tf2onnx-ì„¤ì¹˜\" style=\"position:relative;\"><a href=\"#1-tf2onnx-%EC%84%A4%EC%B9%98\" aria-label=\"1 tf2onnx ì„¤ì¹˜ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. tf2onnx ì„¤ì¹˜</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> -U tf2onnx\n\n<span class=\"token comment\"># í˜„ì¬ ë‚˜ì˜ ë²„ì „ì€ 1.10.0</span>\n<span class=\"token comment\"># ì•Œê³ ìˆê² ì§€ë§Œ -UëŠ” --upgradeì™€ ê°™ë‹¤.</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"2-onnxë¡œ-ëª¨ë¸-ë³€í™˜\" style=\"position:relative;\"><a href=\"#2-onnx%EB%A1%9C-%EB%AA%A8%EB%8D%B8-%EB%B3%80%ED%99%98\" aria-label=\"2 onnxë¡œ ëª¨ë¸ ë³€í™˜ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ONNXë¡œ ëª¨ë¸ ë³€í™˜</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">python -m tf2onnx.convert --saved-model tf_model --output model.onnx --opset <span class=\"token number\">12</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>CLIë¡œ ëª¨ë¸ì„ ë³€í™˜í•  ìˆ˜ ìˆì—ˆë‹¤. ì´ì „ì— ì €ì¥í•œ <code class=\"language-text\">tf_model</code> ì„ <code class=\"language-text\">model.onnx</code> ë¡œ ë³€í™˜í•œë‹¤. ë˜í•œ <code class=\"language-text\">opset</code> ì´ë¼ëŠ” ì¸ìê°€ ìˆëŠ”ë° ì •í™•í•œ ì˜ë¯¸ëŠ” ì˜ ëª¨ë¥´ê² ì§€ë§Œ ONNXì˜ ë²„ì „ì´ë¼ê³  ìƒê°í•˜ë©´ ì¢‹ì„ ê±° ê°™ë‹¤. ì‚¬ìš© ê°€ëŠ¥í•œ ë²„ì „ ë° ìì„¸í•œ ì •ë³´ëŠ” <a href=\"https://github.com/onnx/tensorflow-onnx#tf2onnx---convert-tensorflow-keras-tensorflowjs-and-tflite-models-to-onnx\">ì—¬ê¸°</a> ë¥¼ í™•ì¸í•˜ë©´ ëœë‹¤</p>\n<h4 id=\"3-onnxë¡œ-ì¶”ë¡ í•˜ê¸°\" style=\"position:relative;\"><a href=\"#3-onnx%EB%A1%9C-%EC%B6%94%EB%A1%A0%ED%95%98%EA%B8%B0\" aria-label=\"3 onnxë¡œ ì¶”ë¡ í•˜ê¸° permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. ONNXë¡œ ì¶”ë¡ í•˜ê¸°</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">import</span> onnxruntime\n<span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>datasets <span class=\"token keyword\">import</span> mnist\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\n<span class=\"token comment\"># ì¶”ë¡ ì„ ìœ„í•œ MNIST ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</span>\n<span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>test_x<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> mnist<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># í•™ìŠµì‹œ ì…ë ¥ê³¼ ë°ì´í„° í˜•íƒœë¥¼ ë§ì¶°ì£¼ì—ˆë‹¤. ì´ì „ í•™ìŠµì‹œ float32ëŠ” í•˜ì§€ ì•Šì•˜ì§€ë§Œ ìë™ì ìœ¼ë¡œ ë³€í™˜ë˜ì—ˆë˜ ë¶€ë¶„ì´ë‹¤.</span>\ntest_x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>test_x <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float32'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°</span>\nort_model <span class=\"token operator\">=</span> onnxruntime<span class=\"token punctuation\">.</span>InferenceSession<span class=\"token punctuation\">(</span><span class=\"token string\">'model.onnx'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ì¶”ë¡ í•˜ê¸°</span>\nresult <span class=\"token operator\">=</span> ort_model<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'flatten_input'</span><span class=\"token punctuation\">:</span> test_x<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"predict: \"</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"real: \"</span><span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#   >>></span>\n<span class=\"token comment\">### predict:  7</span>\n<span class=\"token comment\">### real:  7</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ì´ì „ì— ë³´ì§€ ëª»í–ˆë˜ <code class=\"language-text\">flatten_input</code>ì´ë¼ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì…ë ¥ì„ ëª…í™•íˆ í•´ì£¼ëŠ” ë¶€ë¶„ì´ë¼ ì´í•´í–ˆëŠ”ë° ì´ë ‡ê²Œ í•´ì£¼ëŠ” ì´ìœ ëŠ” ì—¬ëŸ¬ ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ë§Œë“¤ì–´ì§„ ëª¨ë¸ì„ ONNXë¡œ ë³€í™˜í•˜ë‹¤ë³´ë‹ˆ ë¬¸ì œê°€ ë  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì„ ì‚¬ì „ì— ë°©ì§€í•˜ê¸° ìœ„í•´ì„œë¼ê³  ìƒê°í•œë‹¤.</p>\n<p>ê·¸ë˜ì„œ ì € ë¶€ë¶„ì— í•„ìš”í•œ <code class=\"language-text\">flatten_input</code> ì´ë¼ëŠ” keyê°’ì€ ë‹¤ìŒì˜ ì½”ë“œì˜ ê²°ê³¼ì—ì„œ ê°€ì ¸ì™”ë‹¤</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">input_names <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">for</span> n <span class=\"token keyword\">in</span> model<span class=\"token punctuation\">.</span>inputs<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">### ['flatten_input']</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>ë‹¹ì—°íˆ ëª¨ë¸ì´ ë³€ê²½ë˜ë©´ ì¶”ë¡ ì— í•„ìš”í•­ keyê°’ë„ ë³€ê²½ëœë‹¤. ì•„ë˜ëŠ” ëª¨ë¸ì´ ë³€ê²½ë˜ì—ˆì„ ë•Œì˜ ì˜ˆì‹œì´ë‹¤. ì°¸ê³ ë§Œ í•˜ë©´ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">inputs <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>inputs<span class=\"token punctuation\">)</span>\noutputs <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nmodel <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">(</span>inputs<span class=\"token operator\">=</span>inputs<span class=\"token punctuation\">,</span> outputs<span class=\"token operator\">=</span>outputs<span class=\"token punctuation\">)</span>\n\ninput_names <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">for</span> n <span class=\"token keyword\">in</span> model<span class=\"token punctuation\">.</span>inputs<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">### ['input_1']</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"4-ì¶”ë¡ -ì •í™•ë„-ë¹„êµ\" style=\"position:relative;\"><a href=\"#4-%EC%B6%94%EB%A1%A0-%EC%A0%95%ED%99%95%EB%8F%84-%EB%B9%84%EA%B5%90\" aria-label=\"4 ì¶”ë¡  ì •í™•ë„ ë¹„êµ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. ì¶”ë¡  ì •í™•ë„ ë¹„êµ</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">import</span> onnxruntime\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\n<span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>test_x<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>mnist<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntest_x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>test_x <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float32'</span><span class=\"token punctuation\">)</span>\n\ntf_model <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>models<span class=\"token punctuation\">.</span>load_model<span class=\"token punctuation\">(</span><span class=\"token string\">'tf_model'</span><span class=\"token punctuation\">)</span>\nort_model <span class=\"token operator\">=</span> onnxruntime<span class=\"token punctuation\">.</span>InferenceSession<span class=\"token punctuation\">(</span><span class=\"token string\">'model.onnx'</span><span class=\"token punctuation\">)</span>\n\ntf_result <span class=\"token operator\">=</span> tf_model<span class=\"token punctuation\">(</span>test_x<span class=\"token punctuation\">)</span>\nort_result <span class=\"token operator\">=</span> ort_model<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'flatten_input'</span><span class=\"token punctuation\">:</span> test_x<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tf result: \"</span><span class=\"token punctuation\">,</span> accuracy_score<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>tf_result<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"onnx result: \"</span><span class=\"token punctuation\">,</span> accuracy_score<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>ort_result<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">#   >>></span>\n<span class=\"token comment\">### tf   result:  0.9584</span>\n<span class=\"token comment\">### onnx result:  0.9584</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ì„±ëŠ¥ì˜ ë³€í™”ê°€ ì „í˜€ ì—†ì—ˆë‹¤. ì‹ ê¸°í•˜ë„¤..</p>\n<h4 id=\"5-ì¶”ë¡ -ì†ë„-ë¹„êµ\" style=\"position:relative;\"><a href=\"#5-%EC%B6%94%EB%A1%A0-%EC%86%8D%EB%8F%84-%EB%B9%84%EA%B5%90\" aria-label=\"5 ì¶”ë¡  ì†ë„ ë¹„êµ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. ì¶”ë¡  ì†ë„ ë¹„êµ</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">import</span> onnxruntime\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> time\n\n<span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>test_x<span class=\"token punctuation\">,</span> test_y<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>mnist<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntest_x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>test_x <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float32'</span><span class=\"token punctuation\">)</span>\n\ntf_model <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>models<span class=\"token punctuation\">.</span>load_model<span class=\"token punctuation\">(</span><span class=\"token string\">'tf_model'</span><span class=\"token punctuation\">)</span>\nort_model <span class=\"token operator\">=</span> onnxruntime<span class=\"token punctuation\">.</span>InferenceSession<span class=\"token punctuation\">(</span><span class=\"token string\">'model.onnx'</span><span class=\"token punctuation\">)</span>\n\ntf_start <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    tf_model<span class=\"token punctuation\">(</span>test_x<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tf running time: \"</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> tf_start<span class=\"token punctuation\">)</span>\n\nort_start <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    ort_model<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'flatten_input'</span><span class=\"token punctuation\">:</span> test_x<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"onnx running time: \"</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> ort_start<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#   >>></span>\n<span class=\"token comment\">### tf   running time:  1.4453675746917725</span>\n<span class=\"token comment\">### onnx running time:  1.1688730716705322</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ì•½ 10% ì •ë„ ONNXê°€ ë” ë¹ ë¥´ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ì¡°ê¸ˆ ë” ë³µì¡í•œ ëª¨ë¸ì„ ì •ì˜í•´ì„œ í…ŒìŠ¤íŠ¸ í•´ë´ì•¼ê² ë‹¤.</p>\n<h4 id=\"6-ì¡°ê¸ˆ-ë”-ë³µì¡í•œ-cnn-ëª¨ë¸-ì†ë„-ë¹„êµ\" style=\"position:relative;\"><a href=\"#6-%EC%A1%B0%EA%B8%88-%EB%8D%94-%EB%B3%B5%EC%9E%A1%ED%95%9C-cnn-%EB%AA%A8%EB%8D%B8-%EC%86%8D%EB%8F%84-%EB%B9%84%EA%B5%90\" aria-label=\"6 ì¡°ê¸ˆ ë” ë³µì¡í•œ cnn ëª¨ë¸ ì†ë„ ë¹„êµ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. ì¡°ê¸ˆ ë” ë³µì¡í•œ CNN ëª¨ë¸ ì†ë„ ë¹„êµ</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">model <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">[</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">\"relu\"</span><span class=\"token punctuation\">,</span> input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPooling2D<span class=\"token punctuation\">(</span>pool_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">\"relu\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPooling2D<span class=\"token punctuation\">(</span>pool_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">\"relu\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">\"softmax\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ë‚˜ë¨¸ì§€ëŠ” ë™ì¼í•´ì„œ ì‘ì„±í•˜ì§€ ì•Šê² ë‹¤!!</p>\n<p>ê²°ê³¼ëŠ” ì•½ 2ë°° ì°¨ì´ ğŸ™Œ</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">tf   running time:  <span class=\"token number\">76.62953901290894</span>\nonnx running time:  <span class=\"token number\">36.256043434143066</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2 id=\"ê²°ë¡ \" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"ê²°ë¡  permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ë¡ </h2>\n<p>ì‚¬ì‹¤ ì´ ONNXë¥¼ ì‚¬ìš©í•˜ë ¤ë˜ ì£¼ëª©ì ì€ ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬(Tensorflow, PyTorch, Scikit-Learn, ---)ë¡œ ë§Œë“¤ì–´ì§„ ëª¨ë¸ì„ í†µì¼ì„±ìˆê²Œ ì„œë¹™í•˜ê¸° ìœ„í•¨ì´ì˜€ëŠ”ë° ì´ëŸ¬í•œ ì¥ì ë¿ë§Œ ì•„ë‹ˆë¼ ì†ë„ í…ŒìŠ¤íŠ¸ì—ì„œ ë´¤ë‹¤ì‹œí”¼ ì•½ ë‘ë°°ì •ë„ ë¹ ë¥´ë‹¤. ì‚¬ìš©í•˜ì§€ ì•Šì„ ì´ìœ ê°€ ì—†ì„ ê²ƒ ê°™ë‹¤. ~</p>","tableOfContents":"<ul>\n<li><a href=\"/category/blog/tensorflow-onnx/#%EB%AA%A9%EC%B0%A8\">ëª©ì°¨</a></li>\n<li><a href=\"/category/blog/tensorflow-onnx/#mnist-%EB%AA%A8%EB%8D%B8-%ED%95%99%EC%8A%B5-%EB%B0%8F-%EC%A0%80%EC%9E%A5\">MNIST ëª¨ë¸ í•™ìŠµ ë° ì €ì¥</a></li>\n<li>\n<p><a href=\"/category/blog/tensorflow-onnx/#onnx\">ONNX</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/blog/tensorflow-onnx/#1-tf2onnx-%EC%84%A4%EC%B9%98\">1. tf2onnx ì„¤ì¹˜</a></li>\n<li><a href=\"/category/blog/tensorflow-onnx/#2-onnx%EB%A1%9C-%EB%AA%A8%EB%8D%B8-%EB%B3%80%ED%99%98\">2. ONNXë¡œ ëª¨ë¸ ë³€í™˜</a></li>\n<li><a href=\"/category/blog/tensorflow-onnx/#3-onnx%EB%A1%9C-%EC%B6%94%EB%A1%A0%ED%95%98%EA%B8%B0\">3. ONNXë¡œ ì¶”ë¡ í•˜ê¸°</a></li>\n<li><a href=\"/category/blog/tensorflow-onnx/#4-%EC%B6%94%EB%A1%A0-%EC%A0%95%ED%99%95%EB%8F%84-%EB%B9%84%EA%B5%90\">4. ì¶”ë¡  ì •í™•ë„ ë¹„êµ</a></li>\n<li><a href=\"/category/blog/tensorflow-onnx/#5-%EC%B6%94%EB%A1%A0-%EC%86%8D%EB%8F%84-%EB%B9%84%EA%B5%90\">5. ì¶”ë¡  ì†ë„ ë¹„êµ</a></li>\n<li><a href=\"/category/blog/tensorflow-onnx/#6-%EC%A1%B0%EA%B8%88-%EB%8D%94-%EB%B3%B5%EC%9E%A1%ED%95%9C-cnn-%EB%AA%A8%EB%8D%B8-%EC%86%8D%EB%8F%84-%EB%B9%84%EA%B5%90\">6. ì¡°ê¸ˆ ë” ë³µì¡í•œ CNN ëª¨ë¸ ì†ë„ ë¹„êµ</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/category/blog/tensorflow-onnx/#%EA%B2%B0%EB%A1%A0\">ê²°ë¡ </a></li>\n</ul>","frontmatter":{"title":"Tensorflow ONNX","description":"","date":"2021.10.02","emoji":"","category":"blog"}}},"pageContext":{"slug":"/category/blog/tensorflow-onnx/","relatedPosts":[{"node":{"fields":{"slug":"/category/blog/interview/"},"frontmatter":{"title":"[ë©´ì ‘ì¤€ë¹„] minimum ì§ˆë¬¸&ë‹µë³€","date":"2021.11.22","emoji":"â“","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/hackerrank_certification/"},"frontmatter":{"title":"í•´ì»¤ë­í¬ ì¸ì¦ì„œ ë°œê¸‰ í›„ê¸°","date":"2021.11.19","emoji":"ğŸ“š","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/m1-tensorflow/"},"frontmatter":{"title":"[Tensorflow] M1ì—ì„œ Tensorflow GPU ì‚¬ìš©í•˜ê¸° (Monterey)","date":"2021.11.13","emoji":"ğŸ’ª","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/effective-python/"},"frontmatter":{"title":"[ì±…] íŒŒì´ì¬ ì½”ë”©ì˜ ê¸°ìˆ ","date":"2021.11.02","emoji":"ğŸ“š","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/mlops/simple_model_deploy_mnist/"},"frontmatter":{"title":"[MLOps] Vertex AIì—ì„œ ëª¨ë¸ ë°°í¬í•˜ê¸° (MNIST)","date":"2021.11.01","emoji":"ğŸƒ","category":"blog"}}}]}}}