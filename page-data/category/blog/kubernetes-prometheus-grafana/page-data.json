{"componentChunkName":"component---src-templates-post-tsx","path":"/category/blog/kubernetes-prometheus-grafana/","result":{"data":{"site":{"siteMetadata":{"title":"어서OpShow","author":"장수완","siteUrl":"https://ssuwani.github.io"}},"markdownRemark":{"id":"ce3fa80c-fcaf-5cc0-a928-9ad21d603b26","excerpt":"GKE를 통한 쿠버네티스 클러스터 생성 및 Prometheus & Grafana 시각화와 알람 설정 목차 Cluster 만들기 ✅ Cloud SDK로 손쉽게 클러스터 다루기 ✅ Prometheus & Grafana 설치 ✅ Slack Alert ✅ 1. Cluster 만들기 GCP…","html":"<h1 id=\"gke를-통한-쿠버네티스-클러스터-생성-및-prometheus--grafana-시각화와-알람-설정\" style=\"position:relative;\"><a href=\"#gke%EB%A5%BC-%ED%86%B5%ED%95%9C-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%83%9D%EC%84%B1-%EB%B0%8F-prometheus--grafana-%EC%8B%9C%EA%B0%81%ED%99%94%EC%99%80-%EC%95%8C%EB%9E%8C-%EC%84%A4%EC%A0%95\" aria-label=\"gke를 통한 쿠버네티스 클러스터 생성 및 prometheus  grafana 시각화와 알람 설정 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GKE를 통한 쿠버네티스 클러스터 생성 및 Prometheus &#x26; Grafana 시각화와 알람 설정</h1>\n<p><strong>목차</strong></p>\n<ol>\n<li>Cluster 만들기 ✅</li>\n<li>Cloud SDK로 손쉽게 클러스터 다루기 ✅</li>\n<li>Prometheus &#x26; Grafana 설치 ✅</li>\n<li>Slack Alert ✅</li>\n</ol>\n<hr>\n<h1 id=\"1-cluster-만들기\" style=\"position:relative;\"><a href=\"#1-cluster-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"1 cluster 만들기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Cluster 만들기</h1>\n<p>GCP의 Google Kubernetes Engine 을 이용해서 Cluster를 만들고자 한다. 가입을 하면 300불(한화로 약 350,000원)을 3개월간 사용할 수 있게 제공해준다. </p>\n<h4 id=\"1-gke-standard-선택\" style=\"position:relative;\"><a href=\"#1-gke-standard-%EC%84%A0%ED%83%9D\" aria-label=\"1 gke standard 선택 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>1. GKE Standard 선택</strong></h4>\n<p><a href=\"https://console.cloud.google.com/kubernetes\">https://console.cloud.google.com/kubernetes</a> 로 이동해서 클러스터 만들기를 클릭하면 GKE Standard 혹은 GKE Autopilot 둘 중 선택할 수 있다. Autopilot이 필수 구성만으로 클러스터를 설정해주고 간편하게 scaling을 할 수 있다고하여 선택했었지만 이후에 Kubeflow Pipeline을 설정하는 중 Autopilot을 통해 만든 클러스터에서는 제공되지 않는다고 하였다. <strong>GKE Standard를 선택하자.</strong></p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/7dda0af0c52bbd8485499b459bb440a6/e72de/Untitled.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.08510638297872%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABhElEQVQ4y61Ty07DMBD0P/MFHDlxhRsfwL9UlZCApnlBm7RNm7fzbDJ4DEaoRVUrWGkyziZe78wmoq5rhGGIOI6x3W6xXC6x2+1gYhzHiyCyLMNkMsFsNoPruphOp7AsC1LKkxsPw6RE3/dI0xQsXFVSF0qSROdOxfEBXx3y4vs+FouFBiUTzBGe58G2bc2E4zjamqIokOc5CoU0yxGuE9VQBcHToijSHrIrvrxer7HZbLSXvOdzrsnMUw2VlGWpuFTFS+ziHJWah6BM01UYBDg3jI+HfgopK7zO5nh+sWDNbd0dsVqt9PTNmnIOvRuGz2LWm8TNg69ZtN2IKOmxiXvIekTXdWjb9gj7/f5oAKbgq1fg+t7SLOiB6zrKbFvzOVJ/fjqm6LfkXBnquJ6a8LueIs2nRDIHEChfycwZ+eQkzRBELbKix9O8wNWtpVnUzR5l1X+fTmmH4LdKKwiTG4YBXT/ofV4gcffoaxb4YxxN+dJ/9XcATdOhbpr/KchoVDH+PR/iYTskfTE2YQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Untitled\" title=\"Untitled\" src=\"/static/7dda0af0c52bbd8485499b459bb440a6/1d69c/Untitled.png\" srcset=\"/static/7dda0af0c52bbd8485499b459bb440a6/4dcb9/Untitled.png 188w,\n/static/7dda0af0c52bbd8485499b459bb440a6/5ff7e/Untitled.png 375w,\n/static/7dda0af0c52bbd8485499b459bb440a6/1d69c/Untitled.png 750w,\n/static/7dda0af0c52bbd8485499b459bb440a6/78797/Untitled.png 1125w,\n/static/7dda0af0c52bbd8485499b459bb440a6/e72de/Untitled.png 1198w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<h4 id=\"2-기본사항-입력\" style=\"position:relative;\"><a href=\"#2-%EA%B8%B0%EB%B3%B8%EC%82%AC%ED%95%AD-%EC%9E%85%EB%A0%A5\" aria-label=\"2 기본사항 입력 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>2. 기본사항 입력</strong></h4>\n<p>클러스터 이름: <strong>monitoring-cluster</strong></p>\n<p>위치유형: 영역 → <strong>asia-northeast3-a</strong> (GCP의 한국리젼의 위치이다. 속도에서 이점이 있다.)</p>\n<p>기타: 노드 수, 머신 유형 등 다양한 선택을 할 수 있지만 default로 둔다.</p>\n<h4 id=\"3-만들기\" style=\"position:relative;\"><a href=\"#3-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"3 만들기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>3. 만들기</strong></h4>\n<p>만들기 클릭 후 5분정도이 시간이 소요되었다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/2bfe5edd11e374cfa85d2b93296e64b4/bf668/Untitled1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 13.829787234042554%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAfElEQVQI122NyQrDQAxD8/9/WGgLpacOCbPvi1oNTMihBvGwbMubCwW1FNzuDzxfb7B67xhjnGL941W8qbVi2/cDWmtIKRFjRM4ZrTWU35OU0qT3fvokvbXHAM5J9kopbOIQMMZAiA+cczOc4kIIYdJaex7QW4EkA5cY/AUapum2J8T3ygAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Untitled1\" title=\"Untitled1\" src=\"/static/2bfe5edd11e374cfa85d2b93296e64b4/1d69c/Untitled1.png\" srcset=\"/static/2bfe5edd11e374cfa85d2b93296e64b4/4dcb9/Untitled1.png 188w,\n/static/2bfe5edd11e374cfa85d2b93296e64b4/5ff7e/Untitled1.png 375w,\n/static/2bfe5edd11e374cfa85d2b93296e64b4/1d69c/Untitled1.png 750w,\n/static/2bfe5edd11e374cfa85d2b93296e64b4/78797/Untitled1.png 1125w,\n/static/2bfe5edd11e374cfa85d2b93296e64b4/aa440/Untitled1.png 1500w,\n/static/2bfe5edd11e374cfa85d2b93296e64b4/bf668/Untitled1.png 2328w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<p>클러스터의 이름을 클릭하면 더 세부적인 내용들을 확인할 수 있다. default로 만든 사양은 다음과 같다.</p>\n<ul>\n<li>Node 3개</li>\n<li>CPU 6개</li>\n<li>RAM 12GB</li>\n</ul>\n<p>이는 머신유형 e2-medium 에 해당되는 사양이다. 이후에 사양이 부족하여 Pod가 <strong><Pending></strong> 으로 유지가 되어 확장을 원할 때 머신유형은 변경할 수 없지만 <strong>노드의 수를 늘려서 문제를 해결할 수 있다</strong>.<br>\n클러스터 세부정보 → 노드 → 노트 풀 → 수정 → 노드 수 변경</p>\n<h1 id=\"2-cloud-sdk로-손쉽게-클러스터-다루기\" style=\"position:relative;\"><a href=\"#2-cloud-sdk%EB%A1%9C-%EC%86%90%EC%89%BD%EA%B2%8C-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EB%8B%A4%EB%A3%A8%EA%B8%B0\" aria-label=\"2 cloud sdk로 손쉽게 클러스터 다루기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Cloud SDK로 손쉽게 클러스터 다루기</h1>\n<h4 id=\"1-cloud-sdk-설치\" style=\"position:relative;\"><a href=\"#1-cloud-sdk-%EC%84%A4%EC%B9%98\" aria-label=\"1 cloud sdk 설치 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>1. Cloud SDK 설치</strong></h4>\n<p>GKE 홈에서 오른쪽 상단의 Cloud Shell을 이용하면 Cluster에 접근이 가능하다. 하지만 번거로워지는 일이 많다. </p>\n<p><a href=\"https://cloud.google.com/sdk/docs/install\">https://cloud.google.com/sdk/docs/install</a> 여기를 참고하여 설치하자.</p>\n<p>설치를 마치고나면 <code class=\"language-text\">gcloud init</code> 을 통해 설정을 추가하면 로컬 터미널에서 클러스터에 바로 접근이 가능하다. </p>\n<h4 id=\"2-설치-확인-및-클러스터-접근\" style=\"position:relative;\"><a href=\"#2-%EC%84%A4%EC%B9%98-%ED%99%95%EC%9D%B8-%EB%B0%8F-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%A0%91%EA%B7%BC\" aria-label=\"2 설치 확인 및 클러스터 접근 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>2. 설치 확인 및 클러스터 접근</strong></h4>\n<p><code class=\"language-text\">kubectl get pods -A</code> 명령어를 통해 Cluster에 배포된 Pod들을 확인할 수 있다. </p>\n<ul>\n<li>kubectl을 아직 설치하지 않았다면 <a href=\"https://kubernetes.io/ko/docs/tasks/tools/#kubectl\">여기</a>를 확인하자.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> kubectl get pods -A\n\nNAMESPACE     NAME                                                           READY   STATUS    RESTARTS   AGE\nkube-system   event-exporter-gke-67986489c8-frqpf                            <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          11m\nkube-system   fluentbit-gke-5nbl9                                            <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          11m\nkube-system   fluentbit-gke-66m6n                                            <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          11m\nkube-system   fluentbit-gke-975p9                                            <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          11m\nkube-system   gke-metrics-agent-l26d9                                        <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   gke-metrics-agent-lxw8z                                        <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   gke-metrics-agent-z8s65                                        <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   konnectivity-agent-7664bbd67c-5gbb6                            <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   konnectivity-agent-7664bbd67c-lltk8                            <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   konnectivity-agent-7664bbd67c-ngllk                            <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   konnectivity-agent-autoscaler-6cb774c9cc-8hfgh                 <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   kube-dns-autoscaler-844c9d9448-x8c7h                           <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   kube-dns-b4f5c58c7-8q7k2                                       <span class=\"token number\">4</span>/4     Running   <span class=\"token number\">0</span>          11m\nkube-system   kube-dns-b4f5c58c7-tzdfv                                       <span class=\"token number\">4</span>/4     Running   <span class=\"token number\">0</span>          11m\nkube-system   kube-proxy-gke-monitoring-cluster-default-pool-197cd47e-12dh   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          10m\nkube-system   kube-proxy-gke-monitoring-cluster-default-pool-197cd47e-nz04   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          10m\nkube-system   kube-proxy-gke-monitoring-cluster-default-pool-197cd47e-tblp   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          10m\nkube-system   l7-default-backend-56cb9644f6-29s4b                            <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          11m\nkube-system   metrics-server-v0.3.6-9c5bbf784-6xfkr                          <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          10m\nkube-system   pdcsi-node-9s4l2                                               <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          11m\nkube-system   pdcsi-node-dbtd6                                               <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          11m\nkube-system   pdcsi-node-fblcx                                               <span class=\"token number\">2</span>/2     Running   <span class=\"token number\">0</span>          11m</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id=\"3-prometheus--grafana-설치\" style=\"position:relative;\"><a href=\"#3-prometheus--grafana-%EC%84%A4%EC%B9%98\" aria-label=\"3 prometheus  grafana 설치 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Prometheus &#x26; Grafana 설치</h1>\n<p>특히 모델 학습을 하는 머신러닝 프로젝트에서 효율적인 하드웨어 관리를 위해서는 모니터링이 필수적이다. </p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/5f7f72563616678f644c20505644148f/29114/flow.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.38297872340425%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABwUlEQVQoz42TwWvUQBjF958RpYKw7YpgseBfIoqIVhDRU2+ePXjRk+BFBVu8a0GLN1nUg4u0tNB2jeum6TY12SSbyZqZ+ZlMkjW7UvANw0wy3/fmzTdvGmTQWpten9d7DiklQggzb7fbNFsLzJ9vcfrsHNduXKdCo0jQqGxUSjMLrRQoSZKRWZbFaDRi4/07zl2Yo7XU5MzCKa7evJJTFISVqgoyhc7Rd7r+UUZUkpZrwXBoxs72LheXLnNpcZH5ZpPlW8uzCmHLluzYCSKK+OLssX/sEMVjRHcH9eYF2j0wxDlp+nWDaOsTYSIJg4A4FpONjcK9geTuWsztlwH7/QBr6NIf+oTRiODRffTzh4yfPiBPi398hvU78O1Z9pX+LU1Zb0Po+Cn3XnmsvD6mZ/u0nU12PYdYpHhvV1Frj0k+riMyCcLvIt0nKG8VLX+TH7BeMkOo0jFWf4B96DIWMdsHDrbnE2XH/xWEHP7sEYpkkjQY2ARhUFNGjTD/MXWt8KHfYdPtlQmqcEBmm0KNMm5Q+e2Xuf8o1KVllAnIWhFr2OvBesZVVUwdjSlp6FqQntTnJOPPPoopwsrgJ72c/8Uf+a44jl/ums8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"flow\" title=\"flow\" src=\"/static/5f7f72563616678f644c20505644148f/1d69c/flow.png\" srcset=\"/static/5f7f72563616678f644c20505644148f/4dcb9/flow.png 188w,\n/static/5f7f72563616678f644c20505644148f/5ff7e/flow.png 375w,\n/static/5f7f72563616678f644c20505644148f/1d69c/flow.png 750w,\n/static/5f7f72563616678f644c20505644148f/78797/flow.png 1125w,\n/static/5f7f72563616678f644c20505644148f/aa440/flow.png 1500w,\n/static/5f7f72563616678f644c20505644148f/29114/flow.png 1920w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<p>시각화까지의 과정을 간단히 그려보았다. 프로메테우스는 pulling의 방법을 사용하여 각종 메트릭을 수집하는 역할을 하고, 그라파나는 이를 이용하여 시각화하는 역할을 수행한다.</p>\n<h4 id=\"1-helm-설치\" style=\"position:relative;\"><a href=\"#1-helm-%EC%84%A4%EC%B9%98\" aria-label=\"1 helm 설치 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>1. Helm 설치</strong></h4>\n<p>Helm은 쿠버네티스 패키지 배포를 손쉽게 해주는 패키지 매니저이다. (nodejs의 npm, python의 pip와 비슷하고 kubectl, kustomize, helm 이렇게 3개가 대표적인 kubenetes용 패키지 매니저이다.)</p>\n<p>설치는 간단히 kubectl과 비슷하게 binary 파일을 다운받아 적절한 위치에 추가만 해주면 된다.</p>\n<p><a href=\"https://helm.sh/ko/docs/intro/install/\">https://helm.sh/ko/docs/intro/install/</a> 를 참고하자.</p>\n<h4 id=\"2-prometheus-operator-설치로-한방에-필요한-도구들-설치\" style=\"position:relative;\"><a href=\"#2-prometheus-operator-%EC%84%A4%EC%B9%98%EB%A1%9C-%ED%95%9C%EB%B0%A9%EC%97%90-%ED%95%84%EC%9A%94%ED%95%9C-%EB%8F%84%EA%B5%AC%EB%93%A4-%EC%84%A4%EC%B9%98\" aria-label=\"2 prometheus operator 설치로 한방에 필요한 도구들 설치 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>2. Prometheus Operator 설치로 한방에 필요한 도구들 설치</strong></h4>\n<p>Prometheus와 Grafana의 설치를 차근차근 따라간다면 설치해야 할 것들이 정말 많다. </p>\n<p>데이터 수집을 도와주는 node-exporter, Pod에 대한 지표를 생성하는 kube-state-metrics </p>\n<p>이를 한번에 설치해주는 Promethues-Operator를 설치해보자. (이를 제대로 사용하기 위해선 Operator Framework에 대한 개념이 필요한 것으로 보인다. <a href=\"https://devthomas.tistory.com/6\">여기</a>를 참고해서 더 공부하자.)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">## prometheus-community 레포 추가\nhelm repo add prometheus-community https://prometheus-community.github.io/helm-charts\n\n# 네임스페이스 생성\nkubectl create namespace monitoring\n\n# 설치\nhelm install -n monitoring monitor prometheus-community/kube-prometheus-stack</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>38 ~ </p>\n<h4 id=\"3-동작확인\" style=\"position:relative;\"><a href=\"#3-%EB%8F%99%EC%9E%91%ED%99%95%EC%9D%B8\" aria-label=\"3 동작확인 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>3. 동작확인</strong></h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&gt;&gt;&gt; kubectl get svc -n monitoring\n\nNAME                                      TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE\nalertmanager-operated                     ClusterIP   None           &lt;none&gt;        9093/TCP,9094/TCP,9094/UDP   8s\nmonitor-grafana                           ClusterIP   10.32.8.212    &lt;none&gt;        80/TCP                       30s\nmonitor-kube-prometheus-st-alertmanager   ClusterIP   10.32.9.98     &lt;none&gt;        9093/TCP                     30s\nmonitor-kube-prometheus-st-operator       ClusterIP   10.32.1.45     &lt;none&gt;        443/TCP                      30s\nmonitor-kube-prometheus-st-prometheus     ClusterIP   10.32.8.236    &lt;none&gt;        9090/TCP                     30s\nmonitor-kube-state-metrics                ClusterIP   10.32.14.210   &lt;none&gt;        8080/TCP                     30s\nmonitor-prometheus-node-exporter          ClusterIP   10.32.2.7      &lt;none&gt;        9100/TCP                     30s\nprometheus-operated                       ClusterIP   None           &lt;none&gt;        9090/TCP                     8s</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>내가 관심있는 것은 <code class=\"language-text\">monitor-kube-prometheus-st-prometheus</code>와 <code class=\"language-text\">monitor-grafana</code> 이다 Type이 ClusterIP로 되어있는 것을 확인하자.</p>\n<h4 id=\"4-prometheus-ui-접속하기\" style=\"position:relative;\"><a href=\"#4-prometheus-ui-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0\" aria-label=\"4 prometheus ui 접속하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>4. Prometheus UI 접속하기</strong></h4>\n<p>서비스 타입이 ClusterIP라면 LoadBalancer혹은 NodePort로 변경하거나 Port-forwarding을 통해 Pod에 직접 접근해야한다. 포트포워딩을 통해 접근해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">kubectl -n monitoring port-forward svc/monitor-kube-prometheus-st-prometheus 9090:9090</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"http://localhost:9090\">localhost:9090</a> 에 접근해보자. 아래와 같은 화면을 볼 수 있다. 크게 3개의 탭으로 구성되어 있다. Alert, Graph, Status. 특히 Status → Target 에 보면 어디서 어떠한 데이터를 가져오는지 확인할 수 있다. 또한 Alert 탭을 확인해보면 기본적으로 다양한 조건들에 대한 Alert이 활성화 되어 있는것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f3cba6977aeea8c1fcdb450ea53645ef/d9ed5/Untitled2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.382978723404253%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABG0lEQVQY05XPXUvCYBjG8X2H1Jm6sjnRfJ0vc246dRNNLemgCPoIQhFEdNBnqTAz6SSiT/jv0S08Curgx33BffHw3JJ70cc9G+CcuButSYfOtEfruIs1crDGW8bAouoZ1PoNX5ArYvamHqPzCVLdcNArJpWaRbFskC+ZpHMGWkZHTRdRUzlULR/IoWXrpA9rYl8WvUaQdUrmmKIpHswWyihqlkRSI6Yk2VUOCEUVduS4LxITM7DO0YRP7DY9ISzLpOqnqM4VkuMe0Wy76FXx7f6QrjekaXew271fdAPbbK3ZNoVCHunmesZi/sjT85y31fvG63L1Ly+LJR+fX9zdPyBlvFtU45JQOCJOSBBanyL/zL/wu9H4PvE9lW+1yNHuTM8HugAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/f3cba6977aeea8c1fcdb450ea53645ef/1d69c/Untitled2.png\"\n        srcset=\"/static/f3cba6977aeea8c1fcdb450ea53645ef/4dcb9/Untitled2.png 188w,\n/static/f3cba6977aeea8c1fcdb450ea53645ef/5ff7e/Untitled2.png 375w,\n/static/f3cba6977aeea8c1fcdb450ea53645ef/1d69c/Untitled2.png 750w,\n/static/f3cba6977aeea8c1fcdb450ea53645ef/78797/Untitled2.png 1125w,\n/static/f3cba6977aeea8c1fcdb450ea53645ef/aa440/Untitled2.png 1500w,\n/static/f3cba6977aeea8c1fcdb450ea53645ef/d9ed5/Untitled2.png 2880w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h4 id=\"5-grafana-ui-접속하기\" style=\"position:relative;\"><a href=\"#5-grafana-ui-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0\" aria-label=\"5 grafana ui 접속하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>5. Grafana UI 접속하기</strong></h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">kubectl -n monitoring port-forward svc/monitor-grafana 8080:80</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"http://localhost:8080\">localhost:8080</a> 에 접근해보자. Login을 해야하는데 Prometheus-Operator를 통해 설치했다면 username: <code class=\"language-text\">admin</code> password: <code class=\"language-text\">prom-operator</code> 로 로그인이 가능하다.</p>\n<p>각각을 따로 설치했다면 Data Source로 Prometheus 를 등록해야 하는데 이미 등록되어 있다.</p>\n<p>시각화를 위한 대시보드를 만들어보자. 아니 불러와보자. 그라파나에서는 프로메테우스의 정보들을 Prometheus Query(PromQL)를 통해 불러올 수 있고, 이를 통해 대시보드를 만들 수 있다. 하지만 다른 사람이 만들어놓은 대시보드를 Import 하고 필요에 따라 세부적인 사항들을 수정해 사용할수도 있다.</p>\n<p>Import로 이동해서 <a href=\"https://grafana.com/grafana/dashboards/1860\">Node Exporter Full</a> 를 추가해보자. ID값은 1860이다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/190b66e69f48d2dc11a15775a6aab1d1/d7e70/Untitled3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.8936170212766%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABLUlEQVQoz43Ru0oDQRQG4Gk190x2d257v2RDzKZINhEJ0UJIiqAoCKIWqXwBEWxiYR2sfCDf7HdcRJBA1uLjP8WZA+cM6RgCjDsQ0sfRYATP76Le6KDRNHY0WyZabWsv4rgxsuEUjpsgn8zRH4yLWtmBFkKqALYTFdmmrBi6D6HURL1WQa16iGrloEjabsG01A5qcNDOfsSNcxyvNphdvmJ2scHp9Ruy+SMsJsGEqzm/uHRLEa87xdnNFsuHdyzutlitP5AvnmAyoRucPwOZsEs4ILYbIopTBGGCOOnB9UK9HofQ9+P6bmXETzL9qVx6IMrrYzg+R9ybQvkZlJfBkilMkZT67qOGjW5+j9vnT0yWLyBchWAqgiUCzS+SyfB/9FtLeLCjEdLxFfz0BF+4l9w/7zM2OQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Untitled3\" title=\"Untitled3\" src=\"/static/190b66e69f48d2dc11a15775a6aab1d1/1d69c/Untitled3.png\" srcset=\"/static/190b66e69f48d2dc11a15775a6aab1d1/4dcb9/Untitled3.png 188w,\n/static/190b66e69f48d2dc11a15775a6aab1d1/5ff7e/Untitled3.png 375w,\n/static/190b66e69f48d2dc11a15775a6aab1d1/1d69c/Untitled3.png 750w,\n/static/190b66e69f48d2dc11a15775a6aab1d1/78797/Untitled3.png 1125w,\n/static/190b66e69f48d2dc11a15775a6aab1d1/d7e70/Untitled3.png 1286w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<p>Datasource로 Prometheus를 선택하고 Import를 누르면 된다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3803fe835cbb8fb827e771f3e2e5bad3/fbf76/Untitled4.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 19.148936170212767%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAdElEQVQY02MwM7f7r61n+l9aVum/pLT8fwkpObKxpJT8fwYVccH/igry/9XUtP8Li0j+5+MXAdNCRGJhJFpCUu4/g0vU5P8Wvk3/1XUs/puaW/3X1jWmyJUMPslz/9sFd/3X0LX6b23j8F/f0AzifKD3ycEANt1tsvruU3YAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Untitled4\" title=\"Untitled4\" src=\"/static/3803fe835cbb8fb827e771f3e2e5bad3/1d69c/Untitled4.png\" srcset=\"/static/3803fe835cbb8fb827e771f3e2e5bad3/4dcb9/Untitled4.png 188w,\n/static/3803fe835cbb8fb827e771f3e2e5bad3/5ff7e/Untitled4.png 375w,\n/static/3803fe835cbb8fb827e771f3e2e5bad3/1d69c/Untitled4.png 750w,\n/static/3803fe835cbb8fb827e771f3e2e5bad3/78797/Untitled4.png 1125w,\n/static/3803fe835cbb8fb827e771f3e2e5bad3/fbf76/Untitled4.png 1252w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<p>다음과 같은 화면을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1d9335cd72db2b262a04076a0a5ab1f9/d9ed5/Untitled5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.57446808510638%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB+UlEQVQoz1VSy3LbMAzUvUkdJ7b1IMW3REmWH3Vmkhw6ObT//01bAKrc5rADiViAiyWK2+8Zp88zrp83wfnnFcP7hPw2EEbEW4L/EQWB4zWif8uEQTC8jxKnjxnzxwWFrloo1UPrhKYOqEqHl2eFzabCfqfxvK3x8O0F3x93Eh8fdthuSjwRtk8V5Zmn0DQedWWpoQkIacIwnWF9Dx8HqDbAuI6QUDcWrY3YVxrWJpQsoPXQ1qOiXFm3OFBOOKVC0XcZOnqYGKCdQxgybKTRhh4uJbicEKcM5wIycYOLmH8d0V0yYhxJAMVuQpdnaVqwinDskYYRKQ/QnqQ3LWpvKGqoaNDwNykpDakj6EzKKKeVQ1VTXnuJDGmoVJDRGDxSa3lUh0OpcTgsaLSTsz2d7fdabLG+k3GZV1KUkavGgH1sNDVUVgpVu4C/BfTtE40deuGxh//gJK5194broSj523iFMh4u9ssjKSuFHL8KWC6ghi0MmelClhECmdzlI2JaDGejlyIPTwqdICP1k/ACfTvaDkU+NnRBUZKRyyiLQlbLZC5a1dbKkLr4tTmtV+qPaE28q+UVKhytCu8fk9YE28BYG2oaKdKlyvDjmYWjFo7sJJ0zWtrNIoQkavj2FezV///86oYKxumE4/kVp8sr8jAvCil/fyAS8Afb4kfo3U9FSgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/1d9335cd72db2b262a04076a0a5ab1f9/1d69c/Untitled5.png\"\n        srcset=\"/static/1d9335cd72db2b262a04076a0a5ab1f9/4dcb9/Untitled5.png 188w,\n/static/1d9335cd72db2b262a04076a0a5ab1f9/5ff7e/Untitled5.png 375w,\n/static/1d9335cd72db2b262a04076a0a5ab1f9/1d69c/Untitled5.png 750w,\n/static/1d9335cd72db2b262a04076a0a5ab1f9/78797/Untitled5.png 1125w,\n/static/1d9335cd72db2b262a04076a0a5ab1f9/aa440/Untitled5.png 1500w,\n/static/1d9335cd72db2b262a04076a0a5ab1f9/d9ed5/Untitled5.png 2880w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>보이는 것 외에도 아래에 더 많은 정보들을 확인할 수 있다. 필요에 따라 대시보드를 수정하고 나만의 대시보드를 만들어 나가자.</p>\n<h1 id=\"4-slack-alert\" style=\"position:relative;\"><a href=\"#4-slack-alert\" aria-label=\"4 slack alert permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Slack Alert</h1>\n<p>Grafana에서 Notification Channel을 추가함으로써 손쉽게 Slack으로 알람을 받을 수 있다.</p>\n<h4 id=\"1-slack-webhook-url-생성\" style=\"position:relative;\"><a href=\"#1-slack-webhook-url-%EC%83%9D%EC%84%B1\" aria-label=\"1 slack webhook url 생성 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>1. Slack Webhook URL 생성</strong></h4>\n<p>Webhook은 외부 시스템에서 슬랙으로 post message를 전달하기 위한 Endpoint라고 이해하면 될 것 같다. Slack Webhook 이라고 검색하면 다양한 블로그들이 있으므로 참고해서 발급받자.</p>\n<h4 id=\"2-grafana-alert-등록-및-테스트\" style=\"position:relative;\"><a href=\"#2-grafana-alert-%EB%93%B1%EB%A1%9D-%EB%B0%8F-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"2 grafana alert 등록 및 테스트 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>2. Grafana Alert 등록 및 테스트</strong></h4>\n<ol>\n<li>\n<p>Grafana UI에서 Alerting 탭을 찾을 수 있을 것이다. Notification channel 탭에서 <strong>Add Channel을 클릭하자.</strong></p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/9c6e4cdcbad87b77abbfce26d285e16b/b0f48/Untitled6.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.063829787234045%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAzElEQVQY022Qyw6CMBRE+QKDGMEE0tIntChKNJq4dOfCpWs3/pRLv3RsS4L4WJzc3s5kMrlRXjDoagVCNeIkwySeI56mIzJMkzef2i/RPM2RZgU4YWi0gaQCyWwxMA7zjLV/RAUR4NIFKeOaWihlUfIKlOswK9NCm3WgtuvgpazX3vQ7KRUiUkpI3QQjc/gpXKj/E7KC7U443x643J/YHK/gXEJ4zXm+YaJ2gVSGpQ8yw1u5u9plB7vaodufAk17wLLduqabwc9HJXzLF9iGiwsbUudfAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Untitled6\" title=\"Untitled6\" src=\"/static/9c6e4cdcbad87b77abbfce26d285e16b/1d69c/Untitled6.png\" srcset=\"/static/9c6e4cdcbad87b77abbfce26d285e16b/4dcb9/Untitled6.png 188w,\n/static/9c6e4cdcbad87b77abbfce26d285e16b/5ff7e/Untitled6.png 375w,\n/static/9c6e4cdcbad87b77abbfce26d285e16b/1d69c/Untitled6.png 750w,\n/static/9c6e4cdcbad87b77abbfce26d285e16b/78797/Untitled6.png 1125w,\n/static/9c6e4cdcbad87b77abbfce26d285e16b/aa440/Untitled6.png 1500w,\n/static/9c6e4cdcbad87b77abbfce26d285e16b/b0f48/Untitled6.png 2690w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n</li>\n<li>\n<p>다음과 같은 화면이 나오는데 적절한 이름과 <strong>Type은 Slack</strong>으로 설정한 뒤 Optional Slack settings 에서 <strong>Webhook URL를 입력하자.</strong></p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/82d075f075c3006c818493a7a5c70a7e/71e8d/Untitled7.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.08510638297872%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABm0lEQVQ4y51Sy26jQBDkDzZOeJrHegAb8xjWYIPtZWVFK62UWw75kJzyAznmpyvdHTtyDt6QHGqmgaZU1dXG1cSGZfsIwlhgWR5SlaKpW6x0gyrXaHSLYBrhx5WFybXzXxhM5hORHyoEUYpEJejKDLu6EvRlgV1VIqf3lhPA8UI47mUYfGz3B6y7AdvdAfvhL/r9LXSzRdv9QUd1kmmYROb5Pz+FYbsBVLIUhS7Z4juMjorf69kosnfCvFghnReY+jOY1hSmfYbjM4/mUzg+zZAOFWdYLDVmKpMPNtmzHf+IQBrHgHsNPnS9kYRZietFb4P/BnhkBpNEsznNKsHkxsGN6eHadOU2x9g8gyjklFWSCdJFiWSeyx2nOabB+DAY3C+hFFWDvFzJfar1LxoDJcw2xpBxnxCywiWlXOo1srwmaKpbGkM6muyDQof3UMWI4xiLrBCrrJD30HL9LxIqXpsQm3+PGO6fMa8GNG0ni77pB1JeS3pvP0QXcXIiKVtkub97wuHhBfnqFu26l51cd7/F/onQ5R8v4Jz0FW/ne9BD2+yOAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Untitled7\" title=\"Untitled7\" src=\"/static/82d075f075c3006c818493a7a5c70a7e/1d69c/Untitled7.png\" srcset=\"/static/82d075f075c3006c818493a7a5c70a7e/4dcb9/Untitled7.png 188w,\n/static/82d075f075c3006c818493a7a5c70a7e/5ff7e/Untitled7.png 375w,\n/static/82d075f075c3006c818493a7a5c70a7e/1d69c/Untitled7.png 750w,\n/static/82d075f075c3006c818493a7a5c70a7e/78797/Untitled7.png 1125w,\n/static/82d075f075c3006c818493a7a5c70a7e/71e8d/Untitled7.png 1304w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n</li>\n<li>\n<p>그리고 <strong>Test</strong>를 눌러 Slack에 알람이 잘 오는지 확인해보자</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f6fdd3e24b15a9be9738ac94c7575cce/7b67d/Untitled8.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20.212765957446805%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAtElEQVQY04WOyxKCMAxF+RGh9EUptZSK1NHxObjj/3/nmjIudKOLM5NJTm5SXOcFfpjQ+QGN9ahFg5IJbCq+UlEtdQsuDdUSrJaoCMYljLcwxkAqguZGahSP54LbZUY83tFPZ7iYYF2PECfE/QFCW9Qk50Cu2i9E067HxEevKEuG05gwpiMULQu6JkhyPsL1kaR32C/IYUJjS36hKDWFgGHMnwWoplulLDCu/4cR+cPsht2EF59ydc4JsO92AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Untitled8\" title=\"Untitled8\" src=\"/static/f6fdd3e24b15a9be9738ac94c7575cce/1d69c/Untitled8.png\" srcset=\"/static/f6fdd3e24b15a9be9738ac94c7575cce/4dcb9/Untitled8.png 188w,\n/static/f6fdd3e24b15a9be9738ac94c7575cce/5ff7e/Untitled8.png 375w,\n/static/f6fdd3e24b15a9be9738ac94c7575cce/1d69c/Untitled8.png 750w,\n/static/f6fdd3e24b15a9be9738ac94c7575cce/78797/Untitled8.png 1125w,\n/static/f6fdd3e24b15a9be9738ac94c7575cce/aa440/Untitled8.png 1500w,\n/static/f6fdd3e24b15a9be9738ac94c7575cce/7b67d/Untitled8.png 2240w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n</li>\n<li>Save</li>\n</ol>","tableOfContents":"<ul>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#gke%EB%A5%BC-%ED%86%B5%ED%95%9C-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%83%9D%EC%84%B1-%EB%B0%8F-prometheus--grafana-%EC%8B%9C%EA%B0%81%ED%99%94%EC%99%80-%EC%95%8C%EB%9E%8C-%EC%84%A4%EC%A0%95\">GKE를 통한 쿠버네티스 클러스터 생성 및 Prometheus &#x26; Grafana 시각화와 알람 설정</a></li>\n<li>\n<p><a href=\"/category/blog/kubernetes-prometheus-grafana/#1-cluster-%EB%A7%8C%EB%93%A4%EA%B8%B0\">1. Cluster 만들기</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#1-gke-standard-%EC%84%A0%ED%83%9D\"><strong>1. GKE Standard 선택</strong></a></li>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#2-%EA%B8%B0%EB%B3%B8%EC%82%AC%ED%95%AD-%EC%9E%85%EB%A0%A5\"><strong>2. 기본사항 입력</strong></a></li>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#3-%EB%A7%8C%EB%93%A4%EA%B8%B0\"><strong>3. 만들기</strong></a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/blog/kubernetes-prometheus-grafana/#2-cloud-sdk%EB%A1%9C-%EC%86%90%EC%89%BD%EA%B2%8C-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EB%8B%A4%EB%A3%A8%EA%B8%B0\">2. Cloud SDK로 손쉽게 클러스터 다루기</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#1-cloud-sdk-%EC%84%A4%EC%B9%98\"><strong>1. Cloud SDK 설치</strong></a></li>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#2-%EC%84%A4%EC%B9%98-%ED%99%95%EC%9D%B8-%EB%B0%8F-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%A0%91%EA%B7%BC\"><strong>2. 설치 확인 및 클러스터 접근</strong></a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/blog/kubernetes-prometheus-grafana/#3-prometheus--grafana-%EC%84%A4%EC%B9%98\">3. Prometheus &#x26; Grafana 설치</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#1-helm-%EC%84%A4%EC%B9%98\"><strong>1. Helm 설치</strong></a></li>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#2-prometheus-operator-%EC%84%A4%EC%B9%98%EB%A1%9C-%ED%95%9C%EB%B0%A9%EC%97%90-%ED%95%84%EC%9A%94%ED%95%9C-%EB%8F%84%EA%B5%AC%EB%93%A4-%EC%84%A4%EC%B9%98\"><strong>2. Prometheus Operator 설치로 한방에 필요한 도구들 설치</strong></a></li>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#3-%EB%8F%99%EC%9E%91%ED%99%95%EC%9D%B8\"><strong>3. 동작확인</strong></a></li>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#4-prometheus-ui-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0\"><strong>4. Prometheus UI 접속하기</strong></a></li>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#5-grafana-ui-%EC%A0%91%EC%86%8D%ED%95%98%EA%B8%B0\"><strong>5. Grafana UI 접속하기</strong></a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/blog/kubernetes-prometheus-grafana/#4-slack-alert\">4. Slack Alert</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#1-slack-webhook-url-%EC%83%9D%EC%84%B1\"><strong>1. Slack Webhook URL 생성</strong></a></li>\n<li><a href=\"/category/blog/kubernetes-prometheus-grafana/#2-grafana-alert-%EB%93%B1%EB%A1%9D-%EB%B0%8F-%ED%85%8C%EC%8A%A4%ED%8A%B8\"><strong>2. Grafana Alert 등록 및 테스트</strong></a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"GKE를 통한 쿠버네티스 클러스터 생성 및 Prometheus & Grafana 시각화와 알람 설정","description":"","date":"2021.10.21","emoji":"⌚️","category":"blog"}}},"pageContext":{"slug":"/category/blog/kubernetes-prometheus-grafana/","relatedPosts":[{"node":{"fields":{"slug":"/category/blog/interview/"},"frontmatter":{"title":"[면접준비] minimum 질문&답변","date":"2021.11.22","emoji":"❓","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/hackerrank_certification/"},"frontmatter":{"title":"해커랭크 인증서 발급 후기","date":"2021.11.19","emoji":"📚","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/m1-tensorflow/"},"frontmatter":{"title":"[Tensorflow] M1에서 Tensorflow GPU 사용하기 (Monterey)","date":"2021.11.13","emoji":"💪","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/effective-python/"},"frontmatter":{"title":"[책] 파이썬 코딩의 기술","date":"2021.11.02","emoji":"📚","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/mlops/simple_model_deploy_mnist/"},"frontmatter":{"title":"[MLOps] Vertex AI에서 모델 배포하기 (MNIST)","date":"2021.11.01","emoji":"🏃","category":"blog"}}}]}}}