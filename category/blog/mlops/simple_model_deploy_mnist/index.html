<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.1cfadd536e0ed4ee026c.css">pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}</style><meta name="generator" content="Gatsby 2.23.3"/><link rel="icon" href="/favicon-32x32.png?v=83455313757f7d5558ecbb4d2c6744cf"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#0c9ee4"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=83455313757f7d5558ecbb4d2c6744cf"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=83455313757f7d5558ecbb4d2c6744cf"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=83455313757f7d5558ecbb4d2c6744cf"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=83455313757f7d5558ecbb4d2c6744cf"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=83455313757f7d5558ecbb4d2c6744cf"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=83455313757f7d5558ecbb4d2c6744cf"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=83455313757f7d5558ecbb4d2c6744cf"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=83455313757f7d5558ecbb4d2c6744cf"/><style type="text/css">
    .anchor-header.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor-header.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor-header svg,
    h2 .anchor-header svg,
    h3 .anchor-header svg,
    h4 .anchor-header svg,
    h5 .anchor-header svg,
    h6 .anchor-header svg {
      visibility: hidden;
    }
    h1:hover .anchor-header svg,
    h2:hover .anchor-header svg,
    h3:hover .anchor-header svg,
    h4:hover .anchor-header svg,
    h5:hover .anchor-header svg,
    h6:hover .anchor-header svg,
    h1 .anchor-header:focus svg,
    h2 .anchor-header:focus svg,
    h3 .anchor-header:focus svg,
    h4 .anchor-header:focus svg,
    h5 .anchor-header:focus svg,
    h6 .anchor-header:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">[MLOps] Vertex AI에서 모델 배포하기 (MNIST) | 어서OpShow</title><link data-react-helmet="true" rel="canonical" href="https://ssuwani.github.io/category/blog/mlops/simple_model_deploy_mnist/"/><meta data-react-helmet="true" name="description" content="간단한 코드로 Vertex AI에서 모델 학습 및 배포하는 과정을 다룬다. MNIST 데이터는 데이터를 불러오는 과정을 간단하게 로 할 수 있기 때문에 아래와 같이 간단히 2개의 컴포넌트로 구성할 수 있다. Load data &amp; Training Deploy with endpoint…"/><meta data-react-helmet="true" property="og:title" content="[MLOps] Vertex AI에서 모델 배포하기 (MNIST)"/><meta data-react-helmet="true" property="og:description" content="간단한 코드로 Vertex AI에서 모델 학습 및 배포하는 과정을 다룬다. MNIST 데이터는 데이터를 불러오는 과정을 간단하게 로 할 수 있기 때문에 아래와 같이 간단히 2개의 컴포넌트로 구성할 수 있다. Load data &amp; Training Deploy with endpoint…"/><meta data-react-helmet="true" property="og:image" content="https://ssuwani.github.io/images/ogp.png"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="google-site-verification" content="imj7G-ZerBh3MsHkiadmx_eAwSqAeRatmOr0p2L0eJs"/><meta data-react-helmet="true" name="naver-site-verification" content="159e698b7dfa582ec3ebdb9c2ad273a4d9a0ed4c"/><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","headline":"[MLOps] Vertex AI에서 모델 배포하기 (MNIST)","image":"https://ssuwani.github.io/images/ogp.png","editor":"장수완","datePublished":"2021-11-01","dateCreated":"2021-11-01","dateModified":"2021-11-01","description":"간단한 코드로 Vertex AI에서 모델 학습 및 배포하는 과정을 다룬다. MNIST 데이터는 데이터를 불러오는 과정을 간단하게 로 할 수 있기 때문에 아래와 같이 간단히 2개의 컴포넌트로 구성할 수 있다. Load data & Training Deploy with endpoint…","author":{"@type":"Person","name":"장수완","image":"https://ssuwani.github.io/images/avatar.png"},"publisher":{"@type":"Organization","name":"장수완","logo":{"@type":"ImageObject","url":"https://ssuwani.github.io/images/avatar.png","width":150,"height":150}}}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://ssuwani.github.io","name":"HOME"}},{"@type":"ListItem","position":2,"item":{"@id":"https://ssuwani.github.io/blog","name":"블로그"}},{"@type":"ListItem","position":3,"item":{"name":"[MLOps] Vertex AI에서 모델 배포하기 (MNIST)"}}]}</script><style data-styled="iiFkmw gNlojF fmzpzu kdMpgf gcLmet liSTQX kAscXg devmEB fTBRLr izTbdK hAYIMS bCIgZk irBJXq KBaLi hyGLFx htBxaS jNtXLx ejjRZu cuevDS AxgAV bpgLWH gFKJVf kilaSx bvCMhp" data-styled-version="4.4.1">
/* sc-component-id: sc-global-4288524390 */
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;-webkit-tap-highlight-color:rgba(0,0,0,0);} html,body{height:100%;} body{--bg:#f5f5f5;--textNormal:#21242d;--headerBackground:#ffffff;--bioBackground:#f5f5f5;--bioColor:rgba(0,0,0,0.87);--bioHighlight:#000000;--categoryHeader:rgba(0,0,0,0.87);--categoryColor:rgba(0,0,0,0.87);--categotyImgage:linear-gradient(-45deg,#ffa649,#f7645b,#805ed4);--postCardColor:rgba(0,0,0,0.87);--postCardHighlight:rgba(0,0,0,0.08);--postCardEmoji:#ffffff;--postCardDivideLine:#969fa7;--tableOfContentsFocusColor:rgb(33,37,41) background-color:var(--bg);color:var(--textNormal);line-height:1.6;font-size:100%;font-weight:400;font-family:"Helvetica Neue",Helvetica,Arial,"Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic Pro","メイリオ",Meiryo,sans-serif;-webkit-text-size-adjust:100%;} body.dark{--bg:#21242d;--textNormal:#21242d;--headerBackground:#3B71DA;--bioBackground:#313746;--bioColor:#ffffff;--bioHighlight:#ffffff;--categoryHeader:#ffffff;--categoryColor:#727d86;--categotyImgage:#313746;--postCardColor:#ffffff;--postCardHighlight:#313746;--postCardEmoji:#313746;--postCardDivideLine:#313746;--tableOfContentsFocusColor:#f1f4f7;background-color:var(--bg);color:var(--textNormal);line-height:1.6;font-size:100%;font-weight:400;font-family:"Helvetica Neue",Helvetica,Arial,"Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic Pro","メイリオ",Meiryo,sans-serif;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased;} article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block;} a{color:#20a8ea;-webkit-text-decoration:none;text-decoration:none;word-break:break-all;-webkit-transition:.2s;transition:.2s;} a:focus{outline:none;} ol,ul,li{list-style:none;} blockquote,q{quotes:none;} blockquote::before,blockquote::after,q::before,q::after{content:'';content:none;} table{border-collapse:collapse;border-spacing:0;} *{box-sizing:border-box;} img{max-width:100%;} button,input{font-family:inherit;font-size:inherit;background:none;border:none;outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:0;resize:none;} button:focus,input:focus{outline:none;}
/* sc-component-id: ContentWrapper__IndexContent-sc-184f5wv-0 */
.gNlojF{max-width:1250px;margin:0 auto;padding:0 1.5em;} @media screen and (max-width:950px){.gNlojF{max-width:760px;}} @media screen and (max-width:500px){.gNlojF{padding:0 20px;}}
/* sc-component-id: Footer__FooterContent-bp79pz-0 */
.kilaSx{padding:0.1em 0;}
/* sc-component-id: Footer__FooterInner-bp79pz-1 */
.bvCMhp{margin-top:3em;text-align:center;padding:1.5em;border-top:solid 1px #313746;color:#727d86;font-size:14px;} .bvCMhp a{color:#727d86;-webkit-text-decoration:underline;text-decoration:underline;}
/* sc-component-id: ColorModeToggle__ToggleButton-sc-1os8jrt-0 */
.kdMpgf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-left:auto;cursor:pointer;} .kdMpgf .icon-sun{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;height:100%;color:#222;} .kdMpgf .icon-moon{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;height:100%;color:#fff;}
/* sc-component-id: Header__HeaderTag-sc-17pj47e-0 */
.iiFkmw{background:var(--headerBackground);width:100%;box-shadow:rgba(0,0,0,0.2) 0px 3px 3px -2px,rgba(0,0,0,0.14) 0px 3px 4px 0px,rgba(0,0,0,0.12) 0px 1px 8px 0px;}
/* sc-component-id: Header__HeaderInner-sc-17pj47e-1 */
.fmzpzu{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:5px;} .fmzpzu .logo{width:150px;height:75px;} @media screen and (max-width:500px){.fmzpzu .logo{margin:0 auto;}} .fmzpzu .message-link{position:absolute;right:0;top:7px;display:block;width:34px;} .fmzpzu .message-link:hover{top:5px;}
/* sc-component-id: Layout__Content-sc-12w4uko-0 */
.gcLmet{margin-top:2em;min-height:85vh;} @media screen and (max-width:950px){.gcLmet{display:block;}} @media screen and (max-width:500px){.gcLmet{margin-top:0;}}
/* sc-component-id: MainWrapper__IndexWrapper-sel83t-0 */
.liSTQX{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;margin-top:2em;min-height:85vh;} @media screen and (max-width:950px){.liSTQX{display:block;}} @media screen and (max-width:500px){.liSTQX{margin-top:0;}}
/* sc-component-id: MainWrapper__ContentsWrapper-sel83t-1 */
.kAscXg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:calc(100% - 290px - 40px);margin-right:40px;} @media screen and (max-width:950px){.kAscXg{width:100%;}}
/* sc-component-id: CategoryLabel__Wrapper-jondgh-0 */
.irBJXq .category-text{padding:0.3em 1em;display:inline-block;display:inline;padding:3px 6px;line-height:1.2;font-size:12px;border-radius:2px;font-weight:700;color:#fff;} @media screen and (max-width:950px){.irBJXq .category-text{font-size:11px;padding:2.5px 6px;}}
/* sc-component-id: RelatedPosts__Wrapper-u5r1r9-0 */
.hyGLFx{background:#f1f4f7;padding:2em 2.5em;} @media screen and (max-width:500px){.hyGLFx{padding:30px 20px;}}
/* sc-component-id: RelatedPosts__PostCardWrapper-u5r1r9-1 */
.htBxaS .post-card-link{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:1em;padding:15px;background:#fff;border-radius:5px;color:#313746;box-shadow:0 1px 2px rgba(0,0,0,0.1);} .htBxaS .post-card-link:hover{background:#e0ebf1;} @media screen and (max-width:500px){.htBxaS .post-card-link{padding:10px;}}
/* sc-component-id: RelatedPosts__PostCardEmoji-u5r1r9-2 */
.jNtXLx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;box-shadow:0 2px 4px rgba(0,0,0,0.4);margin:0;width:80px;height:80px;background:#f1f4f7;border-radius:4px;font-size:50px;} .jNtXLx img{width:55px;height:55px;}
/* sc-component-id: RelatedPosts__PostCardContent-u5r1r9-3 */
.ejjRZu{width:calc(100% - 80px);padding-left:15px;} .ejjRZu h5{font-size:1.1em;font-weight:700;line-height:1.45;} .ejjRZu time{display:block;margin-bottom:0.1em;-webkit-letter-spacing:0.05em;-moz-letter-spacing:0.05em;-ms-letter-spacing:0.05em;letter-spacing:0.05em;font-size:0.8em;color:#969fa7;} @media screen and (max-width:500px){.ejjRZu{padding-left:15px;}.ejjRZu h5{font-size:1em;}}
/* sc-component-id: TableOfContents__TableIndex-v24s1h-0 */
.cuevDS{position:-webkit-sticky;position:sticky;top:2em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:left;-webkit-justify-content:left;-ms-flex-pack:left;justify-content:left;width:320px;padding:1.5em;background:none;border-radius:4px;} @media screen and (max-width:950px){.cuevDS{position:relative;margin:2em 0;width:100%;}} @media screen and (max-width:500px){.cuevDS{padding:1.3em 1em;}}
/* sc-component-id: TableOfContents__TableWrapper-v24s1h-1 */
.AxgAV{display:block;width:100%;max-height:calc(100vh - 150px);word-break:break-word;color:black;overflow:auto;border-left:1.5px solid rgb(233,236,239);}
/* sc-component-id: TableOfContents__TableHeader-v24s1h-2 */
.bpgLWH{display:block;text-align:left;font-size:17px;color:var(--bioColor);padding-left:15px;margin-bottom:15px;}
/* sc-component-id: TableOfContents__TableContents-v24s1h-3 */
.gFKJVf{margin:0 10px;font-size:14px;overflow:hidden;-webkit-transition:all 0.125s ease-in 0s;transition:all 0.125s ease-in 0s;} .gFKJVf a{display:block;color:rgb(134,142,150);} .gFKJVf a:hover{color:var(--tableOfContentsFocusColor);} .gFKJVf ul{list-style:none;margin-left:10px;margin-bottom:0px;line-height:1.5rem;} .gFKJVf ul > li a[href='']{color:var(--tableOfContentsFocusColor);-webkit-transform:scale(1.05);-ms-transform:scale(1.05);transform:scale(1.05);}
/* sc-component-id: post__Content-sc-1poaq2w-0 */
.devmEB{position:relative;background:#fff;overflow:hidden;font-size:16px;} .devmEB:before,.devmEB:after{content:'';position:absolute;width:0;height:0;z-index:5;-webkit-transition:all 0.2s ease-out 0s;transition:all 0.2s ease-out 0s;} .devmEB:before{top:0;left:0;border-top:20px solid var(--bg);border-right:20px solid transparent;} .devmEB:after{bottom:0;right:0;border-bottom:20px solid var(--bg);border-left:20px solid transparent;} @media screen and (max-width:500px){.devmEB{margin:0 -20px;}.devmEB:before,.devmEB:after{content:none;}}
/* sc-component-id: post__HeroImage-sc-1poaq2w-1 */
.fTBRLr{position:relative;background:#313746;text-align:center;background-image:url("/static/pattern-00b88abde489053a0ab3b3e799db37b9.svg");background-repeat:repeat;background-size:400px;min-height:230px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;} .fTBRLr .emoji{width:110px;height:110px;} @media screen and (max-width:500px){.fTBRLr{min-height:190px;}}
/* sc-component-id: post__ContentMain-sc-1poaq2w-2 */
.izTbdK{padding:1.8em 2.5em;} @media screen and (max-width:500px){.izTbdK{padding:30px 20px;}}
/* sc-component-id: post__PostTitle-sc-1poaq2w-3 */
.bCIgZk{margin:0.1em 0 0.3em;font-size:1.8em;font-weight:700;line-height:1.5;} @media screen and (max-width:500px){.bCIgZk{font-size:25px;}}
/* sc-component-id: post__PostDate-sc-1poaq2w-4 */
.hAYIMS{display:block;color:#969fa7;font-size:0.9em;-webkit-letter-spacing:0.05em;-moz-letter-spacing:0.05em;-ms-letter-spacing:0.05em;letter-spacing:0.05em;}
/* sc-component-id: post__PostContent-sc-1poaq2w-5 */
.KBaLi{margin:1.5em 0 1em;line-height:1.9;} .KBaLi .gatsby-highlight{margin:1.5em 0;} @media screen and (max-width:500px){.KBaLi .gatsby-highlight{margin:1.5em -20px;}} .KBaLi code[class*='language-'],.KBaLi pre[class*='language-']{-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;font-family:Menlo,Monaco,'Courier New',monospace;color:#ccc;text-shadow:none;word-break:break-all;} .KBaLi pre[class*='language-'],.KBaLi:not(pre) > code[class*='language-']{background:#313746;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.5);} @media screen and (max-width:500px){.KBaLi pre[class*='language-'],.KBaLi:not(pre) > code[class*='language-']{border-radius:0;}} .KBaLi pre[class*='language-']{padding:1.2em 1.2em;-webkit-overflow-scrolling:touch;position:relative;font-size:14.5px;line-height:1.7;overflow:auto;} .KBaLi .gatsby-highlight pre[class*='language-'].line-numbers{padding-left:3.4em;} .KBaLi pre[class*='language-'].line-numbers span.line-numbers-rows{padding:1.2em 0 1.2em 0.7em;background-color:hsla(0,0%,78.4%,0.15);border:none;} .KBaLi .token.comment,.KBaLi .token.block-comment,.KBaLi .token.prolog,.KBaLi .token.doctype,.KBaLi .token.cdata{color:#999;} .KBaLi .token.punctuation{color:#ccc;} .KBaLi .token.tag,.KBaLi .token.attr-name,.KBaLi .token.namespace,.KBaLi .token.deleted{color:#e2777a;} .KBaLi .token.function-name{color:#6196cc;} .KBaLi .token.boolean,.KBaLi .token.number,.KBaLi .token.function{color:#f08d49;} .KBaLi .token.property,.KBaLi .token.class-name,.KBaLi .token.constant,.KBaLi .token.symbol{color:#f8c555;} .KBaLi .token.selector,.KBaLi .token.important,.KBaLi .token.atrule,.KBaLi .token.keyword,.KBaLi .token.builtin{color:#cc99cd;} .KBaLi .token.string,.KBaLi .token.char,.KBaLi .token.attr-value,.KBaLi .token.regex,.KBaLi .token.variable{color:#7ec699;} .KBaLi .token.operator,.KBaLi .token.entity,.KBaLi .token.url{color:#67cdcc;} .KBaLi .token.important,.KBaLi .token.bold{font-weight:bold;} .KBaLi .token.italic{font-style:italic;} .KBaLi .token.entity{cursor:help;} .KBaLi .token.inserted{color:green;} .KBaLi .gatsby-code-title{position:relative;margin:1.5em 0 -24px auto;background:#616161;color:#fff;font-size:12px;height:24px;padding:0 8px;line-height:24px;font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-weight:500;border-radius:0 5px;display:table;z-index:2;} @media screen and (max-width:500px){.KBaLi .gatsby-code-title{border-radius:0 0 0 5px;margin-right:-20px;}} .KBaLi .gatsby-code-title + .gatsby-highlight{margin-top:0;} .KBaLi p > code,.KBaLi li > code{color:#ff3860 !important;background:#f9f1f3;padding:0.15em 0.4em;margin:0.2em;border-radius:4px;font-size:0.85em;word-break:break-all;white-space:pre-line;} .KBaLi strong > code{font-family:inherit !important;} .KBaLi a:hover{-webkit-text-decoration:underline;text-decoration:underline;} .KBaLi p{margin:0.5em 0;} .KBaLi h1,.KBaLi h2,.KBaLi h3,.KBaLi h4,.KBaLi h5,.KBaLi h6{margin:40px 0 10px;font-weight:700;line-height:1.5;} .KBaLi h1{margin:45px 0 12px;padding:5px 0 5px 17px;font-size:1.55em;} .KBaLi h1:before{position:absolute;top:0;left:0;content:"";display:inline-block;width:5px;height:100%;border-radius:5px;background:linear-gradient(0deg,#ffa649 0%,#ffa649 50%,#f7645b 50%,#f7645b 100%);} .KBaLi h2{position:relative;margin:45px 0 12px;padding:5px 0 5px 17px;font-size:1.40em;} .KBaLi h2:before{position:absolute;top:0;left:0;content:"";display:inline-block;width:5px;height:100%;border-radius:5px;background:linear-gradient(0deg,#ffa649 0%,#ffa649 50%,#f7645b 50%,#f7645b 100%);} .KBaLi h3{margin:40px 0 12px;font-size:1.40em;} .KBaLi h4{position:relative;padding-left:18px;font-size:1.2em;} .KBaLi h4:before{position:absolute;top:.2em;left:0;content:"";display:inline-block;width:14px;height:19px;background-image:url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuODrOOCpOODpOODvF8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiCgkgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMzAgNDUiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwIDQ1OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6I0Y3NjQ1Qzt9Cgkuc3Qxe2ZpbGw6I0ZGQTc0ODt9Cjwvc3R5bGU+Cjx0aXRsZT5pY29uPC90aXRsZT4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTI4LjEsMzAuMWMwLDcuNS02LjEsMTMuNi0xMy42LDEzLjZTMC45LDM3LjcsMC45LDMwLjFTNywxNi41LDE0LjUsMTYuNVMyOC4xLDIyLjYsMjguMSwzMC4xeiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMjguMSwxNS42YzAsNy41LTYuMSwxMy42LTEzLjYsMTMuNlMwLjksMjMuMSwwLjksMTUuNlM3LDIsMTQuNSwyUzI4LjEsOC4xLDI4LjEsMTUuNnoiLz4KPC9zdmc+Cg==");background-size:contain;background-repeat:no-repeat;} .KBaLi ul,.KBaLi ol{margin:1em 0;} .KBaLi ul p,.KBaLi ol p{margin:0;} .KBaLi ul{padding-left:1.2em;} .KBaLi ul li{margin:.4em 0;list-style:disc;} .KBaLi ul ul,.KBaLi ul ol{margin:0;} .KBaLi ol{counter-reset:number;} .KBaLi ol > li{list-style:none;list-style-position:inside;position:relative;padding:0 0 0 30px;margin:0.5em 0;} .KBaLi ol > li:before{display:inline-block;position:absolute;left:0;top:0;width:20px;height:20px;margin:.4em 0;border-radius:25%;background:#5c9ee7;color:#fff;font-weight:700;font-size:14px;text-align:center;line-height:20px;content:counter(number);counter-increment:number;} .KBaLi ol ul{margin:0;} .KBaLi strong{font-weight:550;font-size:1.1em;} .KBaLi em{font-style:italic;} .KBaLi del{-webkit-text-decoration:line-through;text-decoration:line-through;} .KBaLi hr{display:block;margin:2em 0;border:none;border-top:dotted 3px #e1eaf3;} .KBaLi table{display:block;margin:1em 0;border-spacing:2px;border-collapse:separate;overflow:auto;-webkit-overflow-scrolling:touch;width:auto;font-size:.9em;line-height:1.4;} .KBaLi table th{background-color:#313746;color:#FFF;padding:10px 12px;text-align:center;font-weight:700;} .KBaLi table th[align="center"]{text-align:center;} .KBaLi table th[align="right"]{text-align:right;} .KBaLi table td{background-color:#f1f4f7;color:#313746;padding:10px 12px;} .KBaLi table td code[class*='language-']{color:#313746;} .KBaLi table thead tr th:first-child{border-radius:5px 0 0 0;} .KBaLi table thead tr th:last-child{border-radius:0 5px 0 0;} .KBaLi table tbody tr:last-child td:first-child{border-radius:0 0 0 5px;} .KBaLi table tbody tr:last-child td:last-child{border-radius:0 0 5px 0;} .KBaLi blockquote{margin:1em 0;padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5;} .KBaLi .gatsby-resp-image-wrapper{margin:2em 0;box-shadow:1px 1px 20px lightgrey;border-radius:4px;overflow:hidden;} .KBaLi .anchor-header{margin:2px 0 0 0;} .KBaLi .custom-block{margin:1em 0;background:#f1f4f7;} .KBaLi .custom-block-heading{font-weight:700;} .KBaLi .custom-block-heading .emoji{width:1.2em !important;height:1.2em !important;vertical-align:-0.2em !important;} .KBaLi .custom-block-body{font-size:0.92em;} .KBaLi .custom-block-body > *:first-child{margin-top:0;} .KBaLi .custom-block-body > *:last-child{margin-bottom:0;} .KBaLi .custom-block-body h5{font-size:1.05em;margin:20px 0 5px;} .KBaLi > *:first-child{margin-top:0;} .KBaLi .custom-block.simple{padding:1em 1.2em;border-radius:5px;} .KBaLi .custom-block.simple .custom-block-heading{font-size:1.1em;} .KBaLi .custom-block.info,.KBaLi .custom-block.alert,.KBaLi .custom-block.notice{padding:0.7em 1em;border-left:solid 4px #20a8ea;border-radius:1px 3px 3px 1px;} .KBaLi .custom-block.alert{border-left-color:#f7615f;background:#ffeff0;} .KBaLi .custom-block.alert .custom-block-heading{color:#f7615f;} .KBaLi .custom-block.notice{border-left-color:#ffa22b;background:#fff4df;} .KBaLi .custom-block.notice .custom-block-heading{color:#ffa22b;} .KBaLi .custom-block.image-small,.KBaLi .custom-block.image-medium{background:#c0e2fb;padding:1.5em;text-align:center;border-radius:5px;} .KBaLi .custom-block.image-small .gatsby-resp-image-wrapper,.KBaLi .custom-block.image-medium .gatsby-resp-image-wrapper{margin:0;border:none;box-shadow:0 5px 15px rgba(0,0,0,0.15);} .KBaLi .custom-block.image-small .gatsby-resp-image-wrapper{max-width:350px !important;border:none;} .KBaLi .custom-block.image-medium .gatsby-resp-image-wrapper{max-width:450px !important;border:none;}</style><link as="script" rel="preload" href="/webpack-runtime-91cbc5ed6c6972297464.js"/><link as="script" rel="preload" href="/framework-59a9ef51c55d9b62f7de.js"/><link as="script" rel="preload" href="/styles-09367947dddffb36886c.js"/><link as="script" rel="preload" href="/app-e1cbbafd9e0d67222ba1.js"/><link as="script" rel="preload" href="/de71a805-ab927e1633c63597cfb4.js"/><link as="script" rel="preload" href="/53b27b57f60ee3e1ca57a66cde9add975dffb161-2b60719b91291bfda095.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-ee1c336a1aa63cfbc58e.js"/><link as="fetch" rel="preload" href="/page-data/category/blog/mlops/simple_model_deploy_mnist/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="App" style="background-color:var(--bg);color:var(--textNormal);transition:color 0.2s ease-out, background 0.2s ease-out"><header class="Header__HeaderTag-sc-17pj47e-0 iiFkmw"><div class="ContentWrapper__IndexContent-sc-184f5wv-0 gNlojF"><div class="Header__HeaderInner-sc-17pj47e-1 fmzpzu"><a class="logo-link" href="/"><img class="logo" src="/static/logo-ec471251d97b410ffb71148a2ce05745.png" alt="어서OpShow"/></a><div class="ColorModeToggle__ToggleButton-sc-1os8jrt-0 kdMpgf"><div style="position:relative;display:inline-block;text-align:left;opacity:1;direction:ltr;border-radius:13px;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s;touch-action:none;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none"><div class="react-switch-bg" style="height:26px;width:54px;margin:0;position:relative;background:#d9dfe2;border-radius:13px;cursor:pointer;-webkit-transition:background 0.25s;-moz-transition:background 0.25s;transition:background 0.25s"><div style="height:26px;width:29px;position:relative;opacity:0;pointer-events:none;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s"><div class="icon-moon checkedIcon"><svg width="24" height="24" fill="#EFDC05"><rect width="24" height="24" fill="none" rx="0" ry="0"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M14.8102 3.2H13.8202C13.4902 3.2 13.2302 2.93 13.2302 2.6C13.2302 2.27 13.5002 2 13.8302 2H16.2602C16.5002 2 16.7202 2.15 16.8102 2.37C16.9002 2.59 16.8502 2.85 16.6802 3.02L15.2702 4.43H16.2602C16.5902 4.43 16.8602 4.7 16.8602 5.03C16.8602 5.36 16.5902 5.63 16.2602 5.63H13.8202C13.5802 5.63 13.3602 5.48 13.2702 5.26C13.1802 5.04 13.2302 4.78 13.4002 4.61L14.8102 3.2ZM20.1401 11.0101H21.1301C21.4601 11.0101 21.7401 11.2801 21.7401 11.6101C21.7401 11.9401 21.4701 12.2101 21.1401 12.2101H18.7001C18.4601 12.2101 18.2401 12.0601 18.1501 11.8401C18.0601 11.6201 18.1101 11.3601 18.2801 11.1901L19.6901 9.78008H18.7001C18.3701 9.78008 18.1001 9.51008 18.1001 9.18008C18.1001 8.85008 18.3701 8.58008 18.7001 8.58008H21.1301C21.3701 8.58008 21.5901 8.73008 21.6801 8.95008C21.7701 9.17008 21.7201 9.43008 21.5501 9.60008L20.1401 11.0101ZM11.0302 9.8499H12.8502L10.7002 11.9999C10.5302 12.1699 10.4802 12.4299 10.5702 12.6499C10.6602 12.8699 10.8802 13.0199 11.1202 13.0199H14.2902C14.6202 13.0199 14.8902 12.7499 14.8902 12.4199C14.8902 12.0899 14.6202 11.8199 14.2902 11.8199H12.5602L14.7102 9.6699C14.8802 9.4999 14.9302 9.2399 14.8402 9.0199C14.7502 8.7999 14.5302 8.6499 14.2902 8.6499H11.0202C10.6902 8.6499 10.4202 8.9199 10.4202 9.2499C10.4202 9.5799 10.7002 9.8499 11.0302 9.8499ZM14.5501 16.89C15.6601 16.89 16.7201 16.66 17.7101 16.19C17.9401 16.08 18.2101 16.13 18.3801 16.3C18.5601 16.48 18.6101 16.75 18.5001 16.98C17.0901 20.05 13.9901 22.03 10.6001 22.03C5.79013 22.03 1.88013 18.12 1.88013 13.31C1.88013 9.94004 3.87013 6.84004 6.93013 5.40004C7.16013 5.29004 7.43012 5.34004 7.61012 5.52004C7.79012 5.70004 7.84013 5.97004 7.73013 6.20004C7.27013 7.19004 7.03012 8.26004 7.03012 9.38004C7.03012 13.52 10.4001 16.89 14.5501 16.89ZM3.09013 13.31C3.09013 17.46 6.46012 20.83 10.6101 20.83C12.9901 20.83 15.2001 19.7 16.6001 17.85C15.9401 18.01 15.2501 18.09 14.5501 18.09C9.74013 18.09 5.83012 14.18 5.83012 9.38004C5.83012 8.68004 5.91013 7.99004 6.07013 7.32004C4.22013 8.73004 3.09013 10.94 3.09013 13.31Z"></path></svg></div></div><div style="height:26px;width:29px;position:absolute;opacity:1;right:0;top:0;pointer-events:none;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s"><div class="icon-sun uncheckedIcon"><svg stroke="currentColor" fill="currentColor" stroke-width="0" version="1.2" baseProfile="tiny" viewBox="0 0 24 24" size="24" height="24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 6.934l1-2.934c.072-.213.078-.452 0-.682-.188-.553-.789-.848-1.341-.659-.553.189-.847.788-.659 1.341l1 2.934zM4 11c-.213-.072-.452-.078-.682 0-.553.188-.848.789-.659 1.341.189.553.788.847 1.341.659l2.934-1-2.934-1zM12 17.066l-1 2.934c-.072.213-.078.452 0 .682.188.553.789.848 1.341.659.553-.189.847-.788.659-1.341l-1-2.934zM21.341 11.657c-.188-.553-.788-.848-1.341-.659l-2.934 1 2.934 1c.213.072.452.078.682 0 .552-.188.847-.789.659-1.341zM5.636 7.05l2.781 1.367-1.367-2.781c-.1-.202-.265-.375-.482-.482-.524-.258-1.157-.042-1.415.482-.257.523-.041 1.157.483 1.414zM5.153 17.432c-.257.523-.041 1.156.482 1.414.523.257 1.157.041 1.414-.482l1.367-2.781-2.781 1.367c-.201.099-.374.263-.482.482zM18.363 16.949l-2.781-1.367 1.367 2.781c.1.202.264.375.482.482.523.257 1.156.041 1.414-.482s.042-1.157-.482-1.414zM18.844 6.566c.258-.524.042-1.157-.481-1.415-.523-.257-1.157-.041-1.414.482l-1.369 2.783 2.782-1.368c.202-.1.375-.264.482-.482zM12 7.5c-2.481 0-4.5 2.019-4.5 4.5s2.019 4.5 4.5 4.5 4.5-2.019 4.5-4.5-2.019-4.5-4.5-4.5z"></path></svg></div></div></div><div class="react-switch-handle" style="height:26px;width:26px;background:#ffffff;display:inline-block;cursor:pointer;border-radius:50%;position:absolute;transform:translateX(0px);top:0;outline:0;box-shadow:0px 1px 5px rgba(0, 0, 0, 0.6);border:0;-webkit-transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s;-moz-transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s;transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s"></div><input type="checkbox" role="switch" style="border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px" id="normal-switch"/></div></div></div></div></header><div class="ContentWrapper__IndexContent-sc-184f5wv-0 gNlojF"><div class="Layout__Content-sc-12w4uko-0 gcLmet"><main><div class="MainWrapper__IndexWrapper-sel83t-0 liSTQX"><div class="MainWrapper__ContentsWrapper-sel83t-1 kAscXg"><section class="post__Content-sc-1poaq2w-0 devmEB"><p class="post__HeroImage-sc-1poaq2w-1 fTBRLr"><img class="emoji" draggable="false" alt="🏃" src="https://twemoji.maxcdn.com/v/12.1.6/svg/1f3c3.svg"/></p><div class="post__ContentMain-sc-1poaq2w-2 izTbdK"><time class="post__PostDate-sc-1poaq2w-4 hAYIMS">2021.11.01</time><h1 class="post__PostTitle-sc-1poaq2w-3 bCIgZk">[MLOps] Vertex AI에서 모델 배포하기 (MNIST)</h1><div class="CategoryLabel__Wrapper-jondgh-0 irBJXq"><a class="category-text" style="background:#ffa22b" href="/category/blog">블로그</a></div><div class="post__PostContent-sc-1poaq2w-5 KBaLi"><blockquote>
<p>간단한 코드로 Vertex AI에서 모델 학습 및 배포하는 과정을 다룬다.</p>
</blockquote>
<p>MNIST 데이터는 데이터를 불러오는 과정을 간단하게 <code class="language-text">load_data</code>로 할 수 있기 때문에 아래와 같이 간단히 2개의 컴포넌트로 구성할 수 있다.</p>
<ul>
<li>Load data &#x26; Training</li>
<li>Deploy with endpoint</li>
</ul>
<p>아래의 과정을 따라오면 다음과 같은 파이프라인을 설계할 수 있다.</p>
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 716px; ">
      <a class="gatsby-resp-image-link" href="/static/8ceb8ea31754ae3312b62dd43d5264ca/6bbf7/simple_pipeline.png" style="display: block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 108.51063829787235%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC2ElEQVQ4y5VVy1LbQBD0p+eaPyCXHHNJ5ZBbciI5UORCUSkIgRiMbfzAb0mrfa/UzKyQLMcuElQ1pd3Vera3e3rcKYoCdTjnAVCUHs57lGUZg5/6XT885/3GWUirYL2DNAqdOlkIBcpg8f1a43rqEZxGfzCkGKDbvcV4PMF9v4/efR83f7qYTh+bA88ml/h09QWrfLNN6EMACoujbxLH14zS4aZ7h8FwRPEAmWfIhEAuMiTJBmmaNmiP+z/w9uQdEpVtE3IopeCshncmjkWeQ9JbKoP7uUUgGgYLB2U8PF3RGINcSUySGabpHPN0uZvQORcTqCY0jFbYZArDuYQljsZLicVGQmsJKdt7GYxDJ9BV20lrXjjqudD8jUUpWQ1kPOc9B/bvJWyLVNA35wusc14LlXD0FtJFhau13d93DiVrJ7U6g5UTWGsjSqZlLC02uuL079+8mJDRWbUC8gvizMY1S0KcpwYDoVG46pBXIKTr5RLzdRZJZ5601rF0cioh91qEsT59wEq4KMB2zcfDAnN4KGFZi9BCFsehIl2asFW9pWw1344blZlo9nAILiLipyoZ4jGU+D1xJICDdS7u5VBGQ1sDw0FGqG/QiRVPCp7eGqxlQRYTuOv1yKtTPM5muL3rYTxbN4fUqCwdfvpwjpPhGVIp6DZFpIAQerKPxZvPAr8mrGqGn5dXsQlwwuViRspqHHren3/E0dmHiLamqcMEs8Xq6/A4f7aUoIOWedWmRisT/cv16GmeKYFR8hhjLZKIuhEllgI1ghiSg7xKpp8uBXpTQZ7NcTMSSDPR7OPGIah0OPiQxnpb/2LHl7yQqlD5N/JHnjZF01zb+3ZU3ivmZ3WNoyagykY9T6Qnsvq2V17/KmyuSUXiGLl4bgJFvJZWaSyTds3uJdxrX0WFzssRIC6gdOUKTSJg9ZUOWUeP/zfC+OdDygtRtXwWjNdYmIw6M/v4JYRPnBuxiueHkT4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="simple pipeline" title="simple pipeline" src="/static/8ceb8ea31754ae3312b62dd43d5264ca/6bbf7/simple_pipeline.png" srcset="/static/8ceb8ea31754ae3312b62dd43d5264ca/4dcb9/simple_pipeline.png 188w,
/static/8ceb8ea31754ae3312b62dd43d5264ca/5ff7e/simple_pipeline.png 375w,
/static/8ceb8ea31754ae3312b62dd43d5264ca/6bbf7/simple_pipeline.png 716w" sizes="(max-width: 716px) 100vw, 716px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy">
  </a>
    </span>
<h2 id="0-import-library" style="position:relative;"><a href="#0-import-library" aria-label="0 import library permalink" class="anchor-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>0. Import Library</h2>
<p>Library를 불러오는 부분이다.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">import</span> kfp
<span class="token keyword">from</span> kfp <span class="token keyword">import</span> dsl
<span class="token keyword">from</span> kfp<span class="token punctuation">.</span>v2 <span class="token keyword">import</span> compiler
<span class="token keyword">from</span> kfp<span class="token punctuation">.</span>v2<span class="token punctuation">.</span>dsl <span class="token keyword">import</span> <span class="token punctuation">(</span>Artifact<span class="token punctuation">,</span> Dataset<span class="token punctuation">,</span> Input<span class="token punctuation">,</span> InputPath<span class="token punctuation">,</span> Model<span class="token punctuation">,</span> Output<span class="token punctuation">,</span>
                        OutputPath<span class="token punctuation">,</span> ClassificationMetrics<span class="token punctuation">,</span> Metrics<span class="token punctuation">,</span> component<span class="token punctuation">)</span>

<span class="token keyword">from</span> google<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>aiplatform <span class="token keyword">import</span> pipeline_jobs

<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2 id="1-load-data--training-component" style="position:relative;"><a href="#1-load-data--training-component" aria-label="1 load data  training component permalink" class="anchor-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Load data &#x26; Training Component</h2>
<p>데이터를 불러와서 전처리 한 뒤 모델을 정의하고 학습을 진행할 것이다. 사실 각각의 컴포넌트로 구현을 하는 것이 옳을지 모르겠다. 간단하게 배포를 위한 포스팅이니 하나의 컴포넌트로 구성했다.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token decorator annotation punctuation">@component</span><span class="token punctuation">(</span>
    packages_to_install<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"tensorflow"</span><span class="token punctuation">]</span> <span class="token comment"># 1</span>
<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">load_data_and_training</span><span class="token punctuation">(</span>
    output_model<span class="token punctuation">:</span> Output<span class="token punctuation">[</span>Model<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># 2</span>
    metrics<span class="token punctuation">:</span> Output<span class="token punctuation">[</span>Metrics<span class="token punctuation">]</span> <span class="token comment"># 3</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
    
    mnist <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>mnist <span class="token comment"># 4</span>
    <span class="token punctuation">(</span>train_x<span class="token punctuation">,</span> train_y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>test_x<span class="token punctuation">,</span> test_y<span class="token punctuation">)</span> <span class="token operator">=</span> mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    train_x <span class="token operator">=</span> train_x <span class="token operator">/</span> <span class="token number">255.0</span>
    test_x <span class="token operator">=</span> test_x <span class="token operator">/</span> <span class="token number">255.0</span>
    
    model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span> <span class="token comment"># 5</span>
        <span class="token punctuation">[</span>
            tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span>input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">)</span>
    model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span> <span class="token comment"># 6</span>
        optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>
        loss<span class="token operator">=</span><span class="token string">'sparse_categorical_crossentropy'</span><span class="token punctuation">,</span>
        metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_x<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment"># 7</span>
    loss<span class="token punctuation">,</span> acc <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>test_x<span class="token punctuation">,</span> test_y<span class="token punctuation">)</span> <span class="token comment"># 8</span>
    
    metrics<span class="token punctuation">.</span>log_metric<span class="token punctuation">(</span><span class="token string">"acc"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>acc<span class="token operator">*</span><span class="token number">100.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 9</span>
    metrics<span class="token punctuation">.</span>log_metric<span class="token punctuation">(</span><span class="token string">"loss"</span><span class="token punctuation">,</span> loss<span class="token punctuation">)</span>
    metrics<span class="token punctuation">.</span>log_metric<span class="token punctuation">(</span><span class="token string">"Model"</span><span class="token punctuation">,</span> <span class="token string">"LinearModel"</span><span class="token punctuation">)</span>
    metrics<span class="token punctuation">.</span>log_metric<span class="token punctuation">(</span><span class="token string">"dataset size"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>train_x<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    model<span class="token punctuation">.</span>save<span class="token punctuation">(</span>output_model<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token comment"># 10</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Model saved path : </span><span class="token interpolation"><span class="token punctuation">{</span>output_model<span class="token punctuation">.</span>path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Model saved uri : </span><span class="token interpolation"><span class="token punctuation">{</span>output_model<span class="token punctuation">.</span>uri<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>코드 옆에 주석으로 숫자를 표시해두었다. 간단하게 설명을 적어두려 한다.</p>
<ul>
<li>
<p>1: <code class="language-text">kip.v2.dsl</code> 에 정의된 <code class="language-text">component</code>  데코레이터이다. 일반 함수를 파이프라인 컴포넌트로 변경해준다. 3개의 argument를 사용할 수 있다.</p>
<ul>
<li><code class="language-text">base_image</code> : 지정해주지 않으면 기본적으로 python:3.7 이미지를 사용한다.</li>
<li><code class="language-text">output_component_file</code> : component에 정의된 내용을 <code class="language-text">yaml</code> 파일로 작성하여 협업을 위해 사용하거나 다른 파이프라인에서 사용할 수 있다.</li>
<li><code class="language-text">packages_to_install</code>: base_image에서 추가적으로 패키지를 설치할 때 사용한다. 패키지 리스트를 입력해주면 된다. 나의 경우 python:3.7 이미지에 tensorflow를 설치했다.</li>
</ul>
</li>
<li>2: Ouput은 컴포넌트의 출력을 정의할 수 있다. 훈련한 모델을 저장하기 위한 경로를 Deploy Component에서 사용하기 위해 출력했다.</li>
<li>3: Metrics은 위와같이 <code class="language-text">log_metric</code> 으로 값을 주면 Vertex AI Pipeline의 “실행 측정항목” 에서 확인할 수 있을 뿐만 아니라 여러개의 파이프라인을 선택하여 Metrics에 입력한 값을 기반으로 서로 비교할 수 있다.</li>
<li>4: MNIST 데이터셋의 불러오고 전처리를 하는 과정이다.</li>
<li>5: Tensorflow로 간단한 Linear Model을 정의하는 부분이다.</li>
<li>6: 모델 학습과정을 정의하는 compile 부분이다.</li>
<li>7: 모델 학습</li>
<li>8: 모델 평가, 기본적으로 loss를 반환하고 <code class="language-text">compile</code> 시 <code class="language-text">metrics</code> 로 지정했던 측정항목들이 순서대로 출력된다.</li>
<li>9: 3번에서 이야기했던 Component mertric을 지정하는 부분이다. key value의 쌍으로 값을 준다.</li>
<li>10: 모델을 저장하는 부분이다. Output으로 지정했던 output_model의 path에 모델을 저장한다</li>
</ul>
<p>Metrics의 <code class="language-text">log_metric</code> 으로 지정한 뒤 학습의 결과는 다음과 같이 확인할 수 있다.</p>
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; ">
      <a class="gatsby-resp-image-link" href="/static/66509c4bbe52396f3622a91b3810bf09/f79fa/metrics.png" style="display: block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 36.17021276595745%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAvElEQVQoz42R2wqEMBBD/f/fkyo+9aVoFS+oaL1nyUDFBVe3EDo+THIagyzLEMcxlFIIwxB35ziOvxUMw4CqqlCWJay1MjdNI6rrWr6vxm8nGMdRlqZpwrqumOdZtCwLnHPo+17ubdtO033fbyWEaZoiSZKvBU/CMFZijEHXdWLM0EdD/1wuc8ET8GYdRVEIJWfWQMNflGKY5zmiKILW+uzL07ZtK4QMolgFq3kl9EbXZM404Y/xIiFDngg/es0hdD4v0M4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="metrics" title="metrics" src="/static/66509c4bbe52396f3622a91b3810bf09/1d69c/metrics.png" srcset="/static/66509c4bbe52396f3622a91b3810bf09/4dcb9/metrics.png 188w,
/static/66509c4bbe52396f3622a91b3810bf09/5ff7e/metrics.png 375w,
/static/66509c4bbe52396f3622a91b3810bf09/1d69c/metrics.png 750w,
/static/66509c4bbe52396f3622a91b3810bf09/f79fa/metrics.png 940w" sizes="(max-width: 750px) 100vw, 750px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy">
  </a>
    </span>
<p>CNN 모델을 하나 더 만들어서 간단하게 비교해보았다. 참고로만 보자.</p>
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; ">
      <a class="gatsby-resp-image-link" href="/static/4de6fc824e7842db7b8dc9c69e705dd1/b8bf8/compare.png" style="display: block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 14.361702127659576%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAcElEQVQI102NWQpEIQwE3/0vqh/ivm8ZukEYoUhMZfmcc4K395ZzDuNai7wc9efmnOT5/xnEz3svIIQgWJ5zllqrKKUY4YwxjHBaa0kpsddaSzA7xiAfxAONAAL/Uoq01pjHGKX3Tn/v5TEse4dQAz+29ehXBcTD+gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="compare" title="compare" src="/static/4de6fc824e7842db7b8dc9c69e705dd1/1d69c/compare.png" srcset="/static/4de6fc824e7842db7b8dc9c69e705dd1/4dcb9/compare.png 188w,
/static/4de6fc824e7842db7b8dc9c69e705dd1/5ff7e/compare.png 375w,
/static/4de6fc824e7842db7b8dc9c69e705dd1/1d69c/compare.png 750w,
/static/4de6fc824e7842db7b8dc9c69e705dd1/78797/compare.png 1125w,
/static/4de6fc824e7842db7b8dc9c69e705dd1/aa440/compare.png 1500w,
/static/4de6fc824e7842db7b8dc9c69e705dd1/b8bf8/compare.png 1728w" sizes="(max-width: 750px) 100vw, 750px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy">
  </a>
    </span>
<h2 id="2-deploy-with-endpoint" style="position:relative;"><a href="#2-deploy-with-endpoint" aria-label="2 deploy with endpoint permalink" class="anchor-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Deploy with endpoint</h2>
<p>앞서 저장한 모델을 서빙하는 부분이다. 모델을 배포하고 endpoint를 생성하여 연결한다.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token decorator annotation punctuation">@component</span><span class="token punctuation">(</span>
    packages_to_install<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"google-cloud-aiplatform"</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">deploy_model</span><span class="token punctuation">(</span>
    model<span class="token punctuation">:</span> Input<span class="token punctuation">[</span>Model<span class="token punctuation">]</span><span class="token punctuation">,</span>
    project<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span>
    region<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span>
    vertex_endpoint<span class="token punctuation">:</span> Output<span class="token punctuation">[</span>Artifact<span class="token punctuation">]</span><span class="token punctuation">,</span>
    vertex_model<span class="token punctuation">:</span> Output<span class="token punctuation">[</span>Model<span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> google<span class="token punctuation">.</span>cloud <span class="token keyword">import</span> aiplatform

    aiplatform<span class="token punctuation">.</span>init<span class="token punctuation">(</span>project<span class="token operator">=</span>project<span class="token punctuation">,</span> location<span class="token operator">=</span>region<span class="token punctuation">)</span> <span class="token comment"># 1</span>

    deployed_model <span class="token operator">=</span> aiplatform<span class="token punctuation">.</span>Model<span class="token punctuation">.</span>upload<span class="token punctuation">(</span> <span class="token comment"># 2</span>
        display_name<span class="token operator">=</span><span class="token string">"simple-mnist-pipeline"</span><span class="token punctuation">,</span>
        artifact_uri <span class="token operator">=</span> model<span class="token punctuation">.</span>uri<span class="token punctuation">,</span>
        serving_container_image_uri<span class="token operator">=</span><span class="token string">"us-docker.pkg.dev/vertex-ai/prediction/tf2-cpu.2-6:latest"</span>
    <span class="token punctuation">)</span>
    endpoint <span class="token operator">=</span> deployed_model<span class="token punctuation">.</span>deploy<span class="token punctuation">(</span>machine_type<span class="token operator">=</span><span class="token string">"n1-standard-4"</span><span class="token punctuation">)</span> <span class="token comment"># 3</span>

    <span class="token comment"># Save data to the output params</span>
    vertex_endpoint<span class="token punctuation">.</span>uri <span class="token operator">=</span> endpoint<span class="token punctuation">.</span>resource_name <span class="token comment"># 4</span>
    vertex_model<span class="token punctuation">.</span>uri <span class="token operator">=</span> deployed_model<span class="token punctuation">.</span>resource_name </code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<ul>
<li>1: 모델을 업로드하는 과정은 google cloud의 서비스에 종속적이다.</li>
<li>2: 모델 서빙을 위해서 저장한 모델을 불러와서 Vertex ai에서 관리하는 모델로 등록한다. 이때 어떠한 이미지를 기반으로 serving 모델을 만들지 <code class="language-text">serving_container_image_uri</code> 로 지정해줘야 한다.  <a href="https://console.cloud.google.com/artifacts/docker/vertex-ai/us/prediction">여기</a>에 들어가면 Prediction을 위한 다양한 베이스 이미지를 확인할 수 있다.</li>
<li>3: 2에서 업로드한 모델을 endpoint와 연결짓는 부분이다. endpoint를 인자로 주지 않으면 disploy<em>name의 이름으로 자동으로 생성된다. 여기서 배포를 위한 replicas, accelartor 그리고 하나의 엔드포인트에 여러개의 모델이 연결될 수 있으므로 traffic</em>percentage 등도 설정이 가능하다. <a href="https://googleapis.dev/python/aiplatform/latest/aiplatform.html#google.cloud.aiplatform.Model.deploy">여기</a>를 참고하자.</li>
<li>4: component의 Output으로 지정한 <code class="language-text">vertex_endpoint</code> , <code class="language-text">vertex_model</code> 이 처음으로 등장했는데, 단순히 컴포넌트의 결과로서 배포된 모델의 정보와 Endpoint의 정보를 확인하기 위함이다. 사실 꼭 필요한 부분은 아니다. </li>
</ul>
<p>4번과 같이 Ouput을 지정해주면 아래의 사진과 같이 Pipeline에서 정보들을 출력해준다.</p>
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; ">
      <a class="gatsby-resp-image-link" href="/static/a2b0df0382defecad4b0c7697ebf3477/ea64c/outputs.png" style="display: block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 36.17021276595745%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABO0lEQVQoz42QyXLCMBBE+f8/yDXfkVMO5ALZWArMGhsIWfCKbMmS9SKZCiSHVOXQ1apRT0/PdJqmwcM4YBuOpeZpWTGJJMNVwXh9pDfNGKwrZltFsFEMw4K72Qf7ROGaMObk4dH5ZUhDIWqubwWPK8VgHPIw2jAM9uw+Fe9pQ5zBcLfnqnvD4rX6n2E/OPK8dMmCgtFauFSSSSjatPdzQX+e0J2+sTv8aWjPBetQSk0uNFJpVH3h73dRGncag7UXo7OhMQZdK7TWrmAQ0nAodJvW/xnj6o5PW9Ay1pC5W2duqHU9vtfD6ztKW2y5xMgD0eaVMNqwfgkRZQntQlDXtYMzznrUVUK03ROGEcF8wSGOW50f5HUdL5RlgqwESZo5pMRJSureSimklC17cZWHVGVOmuWtxms9fuq+AMNCGfWgKfgfAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="outputs" title="outputs" src="/static/a2b0df0382defecad4b0c7697ebf3477/1d69c/outputs.png" srcset="/static/a2b0df0382defecad4b0c7697ebf3477/4dcb9/outputs.png 188w,
/static/a2b0df0382defecad4b0c7697ebf3477/5ff7e/outputs.png 375w,
/static/a2b0df0382defecad4b0c7697ebf3477/1d69c/outputs.png 750w,
/static/a2b0df0382defecad4b0c7697ebf3477/ea64c/outputs.png 1116w" sizes="(max-width: 750px) 100vw, 750px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy">
  </a>
    </span>
<p>그리고 각 아티팩트의 세부정보를 확인해보면 uri를 확인할 수 있다.</p>
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; ">
      <a class="gatsby-resp-image-link" href="/static/a3a76542555b67e7da698e910876ee32/5f652/artifacts.png" style="display: block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 28.191489361702125%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAp0lEQVQY06WQ2Q7CIBBF+f9vtLXSF7GlC1ipZeAWptUXjUkjycllmTmZIM5lgVpKPJxDXjHGvxDzEuEpbjLgQ3p0CdU53KeZdd8khyecJsuyEAJfEBGstYzbvyHE/Bbe+VOotd6adqH3Hm3TQl0Vhn5ESN9BnlIGruHcoYx/QYwwxrAwT5YblqeHOnVoqh7tZUBTDilHpqsNtDSc+awzctvfilRXjVgBhZPWiFI2OEIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="artifacts" title="artifacts" src="/static/a3a76542555b67e7da698e910876ee32/1d69c/artifacts.png" srcset="/static/a3a76542555b67e7da698e910876ee32/4dcb9/artifacts.png 188w,
/static/a3a76542555b67e7da698e910876ee32/5ff7e/artifacts.png 375w,
/static/a3a76542555b67e7da698e910876ee32/1d69c/artifacts.png 750w,
/static/a3a76542555b67e7da698e910876ee32/78797/artifacts.png 1125w,
/static/a3a76542555b67e7da698e910876ee32/5f652/artifacts.png 1302w" sizes="(max-width: 750px) 100vw, 750px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy">
  </a>
    </span>
<h2 id="3-define-pipeline" style="position:relative;"><a href="#3-define-pipeline" aria-label="3 define pipeline permalink" class="anchor-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Define Pipeline</h2>
<p>위에서 정의한 두개의 컴포넌트를 실행하는 Pipeline을 작성한다.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token decorator annotation punctuation">@dsl<span class="token punctuation">.</span>pipeline</span><span class="token punctuation">(</span>
    pipeline_root<span class="token operator">=</span>PIPELINE_ROOT<span class="token punctuation">,</span> <span class="token comment"># 1</span>
    name<span class="token operator">=</span><span class="token string">"simple-mnist-pipeline"</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">pipeline</span><span class="token punctuation">(</span>
    project<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> PROJECT_ID<span class="token punctuation">,</span> <span class="token comment"># 2</span>
    region<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> REGION
<span class="token punctuation">)</span><span class="token punctuation">:</span>
    load_data_and_training_task <span class="token operator">=</span> load_data_and_training<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 3</span>

    deploy_task <span class="token operator">=</span> deploy_model<span class="token punctuation">(</span> <span class="token comment"># 4</span>
        model<span class="token operator">=</span>load_data_and_training_task<span class="token punctuation">.</span>outputs<span class="token punctuation">[</span><span class="token string">"output_model"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        project<span class="token operator">=</span>project<span class="token punctuation">,</span>
        region<span class="token operator">=</span>region
    <span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<ul>
<li>1: 파이프라인을 실행하면서 생성될 Artifacts를 저장하기 위한 중간 저장소이다. MinIO, S3, GCS 등을 사용할 수 있다.</li>
<li>2: 앞서 설명했다시피 <code class="language-text">deploy_model</code> 의 경우 google cloud에 종속적이다. 파라미터로 값을 받아 deploy를 위해 사용한다.</li>
<li>3: 처음으로 정의한 Load data &#x26; Training Component 를 실행하는 부분이다.</li>
<li>4: 두번째로 정의한 Deploy with endpoint 를 실행하는 부분이다. load<em>data</em>and<em>training</em>task의 ouput 중 output_model를 불러와 입력으로 사용한다.</li>
</ul>
<h2 id="4-run-pipeline" style="position:relative;"><a href="#4-run-pipeline" aria-label="4 run pipeline permalink" class="anchor-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Run Pipeline</h2>
<p>정의한 파이프라인을 Vertex AI에서 실행하는 부분이다.</p>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python">TIMESTAMP <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d%H%M%S"</span><span class="token punctuation">)</span>

compiler<span class="token punctuation">.</span>Compiler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>
    pipeline_func<span class="token operator">=</span>pipeline<span class="token punctuation">,</span> package_path<span class="token operator">=</span><span class="token string">"simple_mnist_pipeline.json"</span>
<span class="token punctuation">)</span>

run <span class="token operator">=</span> pipeline_jobs<span class="token punctuation">.</span>PipelineJob<span class="token punctuation">(</span>
    display_name<span class="token operator">=</span><span class="token string">"simple-mnist-pipeline"</span><span class="token punctuation">,</span>
    template_path<span class="token operator">=</span><span class="token string">"simple_mnist_pipeline.json"</span><span class="token punctuation">,</span>
    job_id<span class="token operator">=</span><span class="token string">"simple-mnist-pipeline-{0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>TIMESTAMP<span class="token punctuation">)</span><span class="token punctuation">,</span>
    parameter_values<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    enable_caching<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

run<span class="token punctuation">.</span>run<span class="token punctuation">(</span>sync<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><aside><div class="RelatedPosts__Wrapper-u5r1r9-0 hyGLFx"><div class="RelatedPosts__PostCardWrapper-u5r1r9-1 htBxaS"><a class="post-card-link" href="/category/blog/interview/"><p class="RelatedPosts__PostCardEmoji-u5r1r9-2 jNtXLx"><img class="emoji" draggable="false" alt="❓" src="https://twemoji.maxcdn.com/v/12.1.6/svg/2753.svg"/></p><div class="RelatedPosts__PostCardContent-u5r1r9-3 ejjRZu"><h5>[면접준비] minimum 질문&amp;답변</h5><time>2021.11.22</time></div></a></div><div class="RelatedPosts__PostCardWrapper-u5r1r9-1 htBxaS"><a class="post-card-link" href="/category/blog/hackerrank_certification/"><p class="RelatedPosts__PostCardEmoji-u5r1r9-2 jNtXLx"><img class="emoji" draggable="false" alt="📚" src="https://twemoji.maxcdn.com/v/12.1.6/svg/1f4da.svg"/></p><div class="RelatedPosts__PostCardContent-u5r1r9-3 ejjRZu"><h5>해커랭크 인증서 발급 후기</h5><time>2021.11.19</time></div></a></div><div class="RelatedPosts__PostCardWrapper-u5r1r9-1 htBxaS"><a class="post-card-link" href="/category/blog/m1-tensorflow/"><p class="RelatedPosts__PostCardEmoji-u5r1r9-2 jNtXLx"><img class="emoji" draggable="false" alt="💪" src="https://twemoji.maxcdn.com/v/12.1.6/svg/1f4aa.svg"/></p><div class="RelatedPosts__PostCardContent-u5r1r9-3 ejjRZu"><h5>[Tensorflow] M1에서 Tensorflow GPU 사용하기 (Monterey)</h5><time>2021.11.13</time></div></a></div><div class="RelatedPosts__PostCardWrapper-u5r1r9-1 htBxaS"><a class="post-card-link" href="/category/blog/effective-python/"><p class="RelatedPosts__PostCardEmoji-u5r1r9-2 jNtXLx"><img class="emoji" draggable="false" alt="📚" src="https://twemoji.maxcdn.com/v/12.1.6/svg/1f4da.svg"/></p><div class="RelatedPosts__PostCardContent-u5r1r9-3 ejjRZu"><h5>[책] 파이썬 코딩의 기술</h5><time>2021.11.02</time></div></a></div></div><div></div></aside></section></div><div class="TableOfContents__TableIndex-v24s1h-0 cuevDS"><div class="TableOfContents__TableWrapper-v24s1h-1 AxgAV table-of-contents"><h1 class="TableOfContents__TableHeader-v24s1h-2 bpgLWH">🔖 Catalog</h1><div class="TableOfContents__TableContents-v24s1h-3 gFKJVf"><ul>
<li><a href="/category/blog/mlops/simple_model_deploy_mnist/#0-import-library">0. Import Library</a></li>
<li><a href="/category/blog/mlops/simple_model_deploy_mnist/#1-load-data--training-component">1. Load data &#x26; Training Component</a></li>
<li><a href="/category/blog/mlops/simple_model_deploy_mnist/#2-deploy-with-endpoint">2. Deploy with endpoint</a></li>
<li><a href="/category/blog/mlops/simple_model_deploy_mnist/#3-define-pipeline">3. Define Pipeline</a></li>
<li><a href="/category/blog/mlops/simple_model_deploy_mnist/#4-run-pipeline">4. Run Pipeline</a></li>
</ul></div></div></div></div></main></div></div><footer class="Footer__FooterContent-bp79pz-0 kilaSx"><div class="ContentWrapper__IndexContent-sc-184f5wv-0 gNlojF"><div class="Footer__FooterInner-bp79pz-1 bvCMhp"><div>© <!-- -->2022<!-- -->, Ssuwani. All rights reserved.</div></div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MM0QK4NLQE"></script><script>
    window.GATSBY_GTAG_PLUGIN_GA_TRACKING_ID = (
      'G-MM0QK4NLQE'
    );
    window.GATSBY_GTAG_PLUGIN_ANONYMIZE = true;

    var options = {
      send_page_view: false
    };
    if (true) {
      options.anonymize_ip = true;
    }

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    window.gtag = gtag;
    gtag('js', new Date());
    gtag('config', 'G-MM0QK4NLQE', options);
  </script><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'none', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/category/blog/mlops/simple_model_deploy_mnist/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e1cbbafd9e0d67222ba1.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-71ad33effa27f873a1fc.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-7c091102bb3698204e45.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-1d80a09e79bd1fe70c2b.js"],"component---src-templates-categories-tsx":["/component---src-templates-categories-tsx-5e2cc865b8dd8344b8ea.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-ee1c336a1aa63cfbc58e.js"]};/*]]>*/</script><script src="/component---src-templates-post-tsx-ee1c336a1aa63cfbc58e.js" async=""></script><script src="/53b27b57f60ee3e1ca57a66cde9add975dffb161-2b60719b91291bfda095.js" async=""></script><script src="/de71a805-ab927e1633c63597cfb4.js" async=""></script><script src="/app-e1cbbafd9e0d67222ba1.js" async=""></script><script src="/styles-09367947dddffb36886c.js" async=""></script><script src="/framework-59a9ef51c55d9b62f7de.js" async=""></script><script src="/webpack-runtime-91cbc5ed6c6972297464.js" async=""></script></body></html>